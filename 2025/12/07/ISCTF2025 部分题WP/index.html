<!DOCTYPE html>
<html lang="zh-CN, en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    
    <meta name="author" content="debu8ger">
    
    <!-- Completely eliminate flash of wrong theme -->
    <script>
        (function() {
            const THEME_KEY = "REDEFINE-THEME-STATUS";
            const DARK = "dark", LIGHT = "light";
            
            // Get preferred theme
            function getTheme() {
                try {
                    const saved = localStorage.getItem(THEME_KEY);
                    if (saved) {
                        const { isDark } = JSON.parse(saved);
                        return isDark ? DARK : LIGHT;
                    }
                } catch (e) {}
                
                return matchMedia("(prefers-color-scheme: dark)").matches ? DARK : LIGHT;
            }
            
            // Apply theme to document
            function applyTheme(theme) {
                const isDark = theme === DARK;
                const root = document.documentElement;
                
                // Set data attribute for CSS variables
                root.setAttribute("data-theme", theme);
                
                // Set classes for compatibility
                root.classList.add(theme);
                root.classList.remove(isDark ? LIGHT : DARK);
                root.style.colorScheme = theme;
            }
            
            // Initial application
            const theme = getTheme();
            applyTheme(theme);
            
            // Listen for system preference changes
            matchMedia("(prefers-color-scheme: dark)").addEventListener("change", ({ matches }) => {
                // Only update if using system preference (no localStorage entry)
                if (!localStorage.getItem(THEME_KEY)) {
                    applyTheme(matches ? DARK : LIGHT);
                }
            });
            
            // Set body classes once DOM is ready
            if (document.readyState !== "loading") {
                document.body.classList.add(theme + "-mode");
            } else {
                document.addEventListener("DOMContentLoaded", () => {
                    document.body.classList.add(theme + "-mode");
                    document.body.classList.remove((theme === DARK ? LIGHT : DARK) + "-mode");
                });
            }
        })();
    </script>
    
    <!-- Critical CSS to prevent flash -->
    <style>
        :root[data-theme="dark"] {
            --background-color: #202124;
            --background-color-transparent: rgba(32, 33, 36, 0.6);
            --second-background-color: #2d2e32;
            --third-background-color: #34353a;
            --third-background-color-transparent: rgba(32, 33, 36, 0.6);
            --primary-color: #0066CC;
            --first-text-color: #ffffff;
            --second-text-color: #eeeeee;
            --third-text-color: #bebec6;
            --fourth-text-color: #999999;
            --default-text-color: #bebec6;
            --invert-text-color: #373D3F;
            --border-color: rgba(255, 255, 255, 0.08);
            --selection-color: #0066CC;
            --shadow-color-1: rgba(255, 255, 255, 0.08);
            --shadow-color-2: rgba(255, 255, 255, 0.05);
        }
        
        :root[data-theme="light"] {
            --background-color: #fff;
            --background-color-transparent: rgba(255, 255, 255, 0.6);
            --second-background-color: #f8f8f8;
            --third-background-color: #f2f2f2;
            --third-background-color-transparent: rgba(241, 241, 241, 0.6);
            --primary-color: #0066CC;
            --first-text-color: #16171a;
            --second-text-color: #2f3037;
            --third-text-color: #5e5e5e;
            --fourth-text-color: #eeeeee;
            --default-text-color: #373D3F;
            --invert-text-color: #bebec6;
            --border-color: rgba(0, 0, 0, 0.08);
            --selection-color: #0066CC;
            --shadow-color-1: rgba(0, 0, 0, 0.08);
            --shadow-color-2: rgba(0, 0, 0, 0.05);
        }
        
        body {
            background-color: var(--background-color);
            color: var(--default-text-color);
        }
        
        /* Apply body classes as soon as DOM is ready */
        :root[data-theme="dark"] body {
            background-color: var(--background-color);
            color: var(--default-text-color);
        }
    </style>
    
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    
    <!--- Seo Part-->
    
    <link rel="canonical" href="https://incldue.github.io/2025/12/07/isctf2025 部分题wp/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
    
    
        
        <meta name="description" content="debu8ger&#39;s CTF tech blog">
<meta property="og:type" content="article">
<meta property="og:title" content="ISCTF2025 部分题WP">
<meta property="og:url" content="https://incldue.github.io/2025/12/07/ISCTF2025%20%E9%83%A8%E5%88%86%E9%A2%98WP/index.html">
<meta property="og:site_name" content="D&#39;b8Gr的小站~">
<meta property="og:description" content="debu8ger&#39;s CTF tech blog">
<meta property="og:locale">
<meta property="og:image" content="https://incldue.github.io/static/bgimage/night.png">
<meta property="article:published_time" content="2025-12-06T16:00:00.000Z">
<meta property="article:modified_time" content="2025-12-07T09:45:27.397Z">
<meta property="article:author" content="debu8ger">
<meta property="article:tag" content="比赛个人WP">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://incldue.github.io/static/bgimage/night.png">
    
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="../../../../static/avatar/avatar.png" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="../../../../static/avatar/avatar.png">
    <meta name="theme-color" content="#3CB371">
    <link rel="shortcut icon" href="../../../../static/avatar/avatar.png">
    <!--- Page Info-->
    
    <title>
        
            ISCTF2025 部分题WP | D&#39;b8Gr的小站
        
    </title>

    
<link rel="stylesheet" href="fonts/Chillax/chillax.css">


    <!--- Inject Part-->
    

    
<link rel="stylesheet" href="../../../../css/style.css">


    
        
<link rel="stylesheet" href="../../../../css/build/tailwind.css">

    

    
<link rel="stylesheet" href="fonts/GeistMono/geist-mono.css">

    
<link rel="stylesheet" href="fonts/Geist/geist.css">

    <!--- Font Part-->
    
    
    
    
    
    
        
<script src="js/build/libs/anime.min.js"></script>

    

    <script id="hexo-configurations">
    window.config = {"hostname":"incldue.github.io","root":"/","language":"zh-CN, en"};
    window.theme = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"14px","image_alignment":"center","image_caption":false,"link_icon":true,"delete_mask":false,"title_alignment":"left","headings_top_spacing":{"h1":"2.8rem","h2":"2.4rem","h3":"1.9rem","h4":"1.6rem","h5":"1.4rem","h6":"1.3rem"}},"word_count":{"enable":true,"count":true,"min2read":true},"author_label":{"enable":true,"auto":false,"list":[]},"code_block":{"copy":true,"style":"mac","highlight_theme":{"light":"atom-one-light","dark":"monokai-sublime"},"font":{"enable":false,"family":null,"url":null}},"toc":{"enable":true,"max_depth":3,"number":true,"expand":true,"init_open":true},"copyright":{"enable":false,"default":"cc_by_nc_sa"},"lazyload":true,"pangu_js":false,"recommendation":{"enable":false,"title":"推荐阅读","limit":3,"mobile_limit":2,"placeholder":"/images/wallhaven-wqery6-light.webp","skip_dirs":[]}},"colors":{"primary":"#3CB371","secondary":"#41697D","default_mode":"light"},"global":{"fonts":{"chinese":{"enable":false,"family":"Noto Sans SC","url":"https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap"},"english":{"enable":false,"family":"Farsan","url":"https://fonts.googleapis.com/css2?family=Farsan&display=swap"},"title":{"enable":false,"family":null,"url":null}},"content_max_width":"1050px","sidebar_width":"230px","hover":{"shadow":true,"scale":true},"scroll_progress":{"bar":true,"percentage":true},"website_counter":{"url":"https://cn.vercount.one/js","enable":true,"site_pv":true,"site_uv":true,"post_pv":true},"single_page":true,"preloader":{"enable":true,"custom_message":"欢迎来到debu8gerのCTF小站"},"side_tools":{"gear_rotation":true,"auto_expand":true},"open_graph":{"enable":true,"image":"/static/bgimage/night.png","description":"debu8ger's CTF tech blog"},"google_analytics":{"enable":false,"id":null}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"/static/bgimage/night.png","dark":"/static/bgimage/night.png"},"title":"D'b8Gr的小站","subtitle":{"text":["my way to record my learning experience","welcome"],"hitokoto":{"enable":true,"show_author":false,"api":"https://v1.hitokoto.cn?c=e&c=k"},"typing_speed":100,"backing_speed":80,"starting_delay":300,"backing_delay":1500,"loop":true,"smart_backspace":true},"text_color":{"light":"#fff","dark":"#d1d1b6"},"text_style":{"title_size":"2.8rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":true,"style":"center","links":{"github":"https://github.com/incldue","instagram":null,"zhihu":null,"twitter":"https://x.com/JonathanHu70782","email":"h52463398@outlook.com","fa-brands fa-bilibili":"https://space.bilibili.com/2114835832","qq":"524633948@qq.com"},"qrs":null}},"plugins":{"feed":{"enable":false},"aplayer":{"enable":false,"type":"fixed","audios":[{"name":null,"artist":null,"url":null,"cover":null,"lrc":null}]},"mermaid":{"enable":false,"version":"11.4.1"}},"version":"2.8.5","navbar":{"auto_hide":true,"color":{"left":"#f78736","right":"#367df7","transparency":40},"width":{"home":"1200px","pages":"1000px"},"links":{"首页":{"path":"//incldue.github.io","icon":"fa-regular fa-house"},"归档":{"path":"/archives","icon":"fa-regular fa-archive"},"关于":{"icon":"fa-regular fa-user","submenus":{"我":"/about","github":"https://github.com/incldue","博客":"https://incldue.github.io","朋友们":"/friends"}}},"search":{"enable":true,"preload":true}},"page_templates":{"friends_column":2,"tags_style":"blur"},"home":{"sidebar":{"enable":true,"position":"left","first_item":"menu","announcement":"no system is secure","show_on_mobile":true,"links":{"归档":{"path":"/archives","icon":"fa-regular fa-archive"},"标签":{"path":"/tags","icon":"fa-regular fa-tags"},"分类":{"path":"/categories","icon":"fa-regular fa-folder"}}},"article_date_format":"auto","excerpt_length":100,"categories":{"enable":true,"limit":4},"tags":{"enable":true,"limit":4}},"footerStart":"2024/10/13"};
    window.lang_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
    window.data = {"masonry":false};
  </script>
    
    <!--- Fontawesome Part-->
    
<link rel="stylesheet" href="fontawesome/fontawesome.min.css">

    
<link rel="stylesheet" href="fontawesome/brands.min.css">

    
<link rel="stylesheet" href="fontawesome/solid.min.css">

    
<link rel="stylesheet" href="fontawesome/regular.min.css">

    
    
    
        
<link rel="stylesheet" href="fontawesome/duotone.min.css">

    
    
<meta name="generator" content="Hexo 7.3.0"></head>



<body>
	<div class="progress-bar-container">
	
	<span class="scroll-progress-bar"></span>
	

	
	<span class="pjax-progress-bar"></span>
	<!--        <span class="swup-progress-icon">-->
	<!--            <i class="fa-solid fa-circle-notch fa-spin"></i>-->
	<!--        </span>-->
	
</div>

<style>
    :root {
        --preloader-background-color: #fff;
        --preloader-text-color: #000;
    }

    @media (prefers-color-scheme: dark) {
        :root {
            --preloader-background-color: #202124;
            --preloader-text-color: #fff;
        }
    }

    @media (prefers-color-scheme: light) {
        :root {
            --preloader-background-color: #fff;
            --preloader-text-color: #000;
        }
    }

    @media (max-width: 600px) {
        .ml13 {
            font-size: 2.6rem !important; /* Adjust this value as needed */
        }
    }

    .preloader {
        display: flex;
        flex-direction: column;
        gap: 1rem; /* Tailwind 'gap-4' is 1rem */
        align-items: center;
        justify-content: center;
        position: fixed;
        padding: 12px;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        width: 100vw;
        height: 100vh; /* 'h-screen' is 100% of the viewport height */
        background-color: var(--preloader-background-color);
        z-index: 1100; /* 'z-[1100]' sets the z-index */
        transition: opacity 0.2s ease-in-out;
    }

    .ml13 {
        font-size: 3.2rem;
        /* text-transform: uppercase; */
        color: var(--preloader-text-color);
        letter-spacing: -1px;
        font-weight: 500;
        font-family: 'Chillax-Variable', sans-serif;
        text-align: center;
    }

    .ml13 .word {
        display: inline-flex;
        flex-wrap: wrap;
        white-space: nowrap;
    }

    .ml13 .letter {
        display: inline-block;
        line-height: 1em;
    }
</style>

<div class="preloader">
    <h2 class="ml13">
        欢迎来到debu8gerのCTF小站
    </h2>
    <script>
        var textWrapper = document.querySelector('.ml13');
        // Split text into words
        var words = textWrapper.textContent.trim().split(' ');

        // Clear the existing content
        textWrapper.innerHTML = '';

        // Wrap each word and its letters in spans
        words.forEach(function(word) {
            var wordSpan = document.createElement('span');
            wordSpan.classList.add('word');
            wordSpan.innerHTML = word.replace(/\S/g, "<span class='letter'>$&</span>");
            textWrapper.appendChild(wordSpan);
            textWrapper.appendChild(document.createTextNode(' ')); // Add space between words
        });

        var animation = anime.timeline({ loop: true })
            .add({
                targets: '.ml13 .letter',
                translateY: [20, 0],
                translateZ: 0,
                opacity: [0, 1],
                filter: ['blur(5px)', 'blur(0px)'],
                easing: "easeOutExpo",
                duration: 1200,
                delay: (el, i) => 300 + 20 * i,
            })
            .add({
                targets: '.ml13 .letter',
                translateY: [0, -20],
                opacity: [1, 0],
                filter: ['blur(0px)', 'blur(5px)'],
                easing: "easeInExpo",
                duration: 1000,
                delay: (el, i) => 15 * i,
                complete: function() {
                    hidePreloader();
                }
            }, '-=700');


        let themeStatus = JSON.parse(localStorage.getItem('REDEFINE-THEME-STATUS'))?.isDark;

        // If the theme status is not found in local storage, check the preferred color scheme
        if (themeStatus === undefined || themeStatus === null) {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                themeStatus = 'dark';
            } else {
                themeStatus = 'light';
            }
        }

        // Now you can use the themeStatus variable in your code
        if (themeStatus) {
            document.documentElement.style.setProperty('--preloader-background-color', '#202124');
            document.documentElement.style.setProperty('--preloader-text-color', '#fff');
        } else {
            document.documentElement.style.setProperty('--preloader-background-color', '#fff');
            document.documentElement.style.setProperty('--preloader-text-color', '#000');
        }

        window.addEventListener('load', function () {
            setTimeout(hidePreloader, 5000); // Call hidePreloader after 5000 milliseconds if not already called by animation
        });

        function hidePreloader() {
            var preloader = document.querySelector('.preloader');
            preloader.style.opacity = '0';
            setTimeout(function () {
                preloader.style.display = 'none';
            }, 200);
        }
    </script>
</div>

<main class="page-container" id="swup">

	

	<div class="main-content-container flex flex-col justify-between min-h-dvh">
		<div class="main-content-header">
			<header class="navbar-container px-6 md:px-12">
    <div class="navbar-content transition-navbar ">
        <div class="left">
            
                <a class="logo-image h-8 w-8 sm:w-10 sm:h-10 mr-3" href="/">
                    <img src="../../../../static/avatar/avatar0.jpg" class="w-full h-full rounded-xs">
                </a>
            
            <a class="logo-title" href="/">
                
                D&#39;b8Gr的小站
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="//incldue.github.io"
                                        >
                                    <i class="fa-regular fa-house fa-fw"></i>
                                    首页
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="../../../../archives"
                                        >
                                    <i class="fa-regular fa-archive fa-fw"></i>
                                    归档
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="has-dropdown"
                                   href="#"
                                        onClick=&#34;return false;&#34;>
                                    <i class="fa-regular fa-user fa-fw"></i>
                                    关于
                                    <i class="fa-solid fa-chevron-down fa-fw"></i>
                                </a>

                                <!-- Submenu -->
                                
                                    <ul class="sub-menu">
                                        
                                            <li>
                                                <a href="../../../../about">
                                                    我
                                                </a>
                                            </li>
                                        
                                            <li>
                                                <a target="_blank" rel="noopener" href="https://github.com/incldue">
                                                    GITHUB
                                                </a>
                                            </li>
                                        
                                            <li>
                                                <a href="https://incldue.github.io">
                                                    博客
                                                </a>
                                            </li>
                                        
                                            <li>
                                                <a href="../../../../friends">
                                                    朋友们
                                                </a>
                                            </li>
                                        
                                    </ul>
                                
                            </li>
                    
                    
                        <li class="navbar-item search search-popup-trigger">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </li>
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i>
                    </div>
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile sheet -->
    <div class="navbar-drawer h-dvh w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between">
        <ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start">
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="//incldue.github.io"
                        >
                            <span>
                                首页
                            </span>
                            
                                <i class="fa-regular fa-house fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="../../../../archives"
                        >
                            <span>
                                归档
                            </span>
                            
                                <i class="fa-regular fa-archive fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item-sub text-base my-1.5 flex flex-col w-full">
                        
                        <div class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary cursor-pointer text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                             navbar-data-toggle="submenu-关于"
                        >
                            <span>
                                关于
                            </span>
                            
                                <i class="fa-solid fa-chevron-right fa-sm fa-fw transition-all"></i>
                            
                        </div>
                        

                        
                            <div class="flex-col items-start px-2 py-2 hidden" data-target="submenu-关于">
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           href="../../../../about">我</a>
                                    </div>
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           target="_blank" rel="noopener" href="https://github.com/incldue">GITHUB</a>
                                    </div>
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           href="https://incldue.github.io">博客</a>
                                    </div>
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           href="../../../../friends">朋友们</a>
                                    </div>
                                
                            </div>
                        
                    </li>
            

            
            
                
                    
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="../../../../tags"
                        >
                            <span>标签</span>
                            <i class="fa-regular fa-tags fa-sm fa-fw"></i>
                        </a>
                    </li>
                
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="../../../../categories"
                        >
                            <span>分类</span>
                            <i class="fa-regular fa-folder fa-sm fa-fw"></i>
                        </a>
                    </li>
                
            
        </ul>

        <div class="statistics flex justify-around my-2.5">
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="../../../../tags">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">12</div>
        <div class="label text-third-text-color text-sm">Tags</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="../../../../categories">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">4</div>
        <div class="label text-third-text-color text-sm">Categories</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="../../../../archives">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">21</div>
        <div class="label text-third-text-color text-sm">Posts</div>
    </a>
</div>
    </div>

    <div class="window-mask"></div>

</header>


		</div>

		<div class="main-content-body transition-fade-up">
			

			<div class="main-content">
				<div class="post-page-container flex relative justify-between box-border w-full h-full">
	<div class="article-content-container">

		<div class="article-title relative w-full">
			
			<div class="w-full flex items-center pt-6 justify-start">
				<h1 class="article-title-regular text-second-text-color tracking-tight text-4xl md:text-6xl font-semibold px-2 sm:px-6 md:px-8 py-3">ISCTF2025 部分题WP</h1>
			</div>
			
		</div>

		
		<div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8">
			<div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]">
				<img src="../../../../static/avatar/avatar0.jpg">
			</div>
			<div class="info flex flex-col justify-between">
				<div class="author flex items-center">
					<span class="name text-default-text-color text-lg font-semibold">debu8ger</span>
					
					<span class="author-label ml-1.5 text-xs px-2 py-0.5 rounded-small text-third-text-color border border-shadow-color-1">Lv3</span>
					
				</div>
				<div class="meta-info">
					<div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2025-12-07 00</span>
        <span class="mobile">2025-12-07 00</span>
        <span class="hover-info">Created</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2025-12-07 17:45</span>
            <span class="mobile">2025-12-07 17:45</span>
            <span class="hover-info">Updated</span>
        </span>
    

    
        <span class="article-categories article-meta-item">
            <i class="fa-regular fa-folders"></i>&nbsp;
            <ul>
                
                
                    
                        
                        <li>
                            <a href="../../../../categories/CTF%E7%9B%B8%E5%85%B3/">CTF相关</a>&nbsp;
                        </li>
                    
                    
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fa-regular fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="../../../../tags/%E6%AF%94%E8%B5%9B%E4%B8%AA%E4%BA%BAWP/">比赛个人WP</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
    
    
        <span class="article-pv article-meta-item">
            <i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

				</div>
			</div>
		</div>
		

		


		<div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8">
			<h3 id="SIGNIN"><a href="#SIGNIN" class="headerlink" title="SIGNIN"></a>SIGNIN</h3><h4 id="Ez-Caesar"><a href="#Ez-Caesar" class="headerlink" title="Ez_Caesar"></a>Ez_Caesar</h4><hr>
<p>题目描述：小蓝鲨看你们牢底坐穿决定送你们一点分。</p>
<hr>
<p>下载附件：</p>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">variant_caesar_encrypt</span>(<span class="params">text</span>):</span><br><span class="line">    encrypted = <span class="string">&quot;&quot;</span></span><br><span class="line">    shift = <span class="number">2</span></span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> text:</span><br><span class="line">        <span class="keyword">if</span> char.isalpha():</span><br><span class="line">            <span class="keyword">if</span> char.isupper():</span><br><span class="line">                base = <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line">                new_char = <span class="built_in">chr</span>((<span class="built_in">ord</span>(char) - base + shift) % <span class="number">26</span> + base)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                base = <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">                new_char = <span class="built_in">chr</span>((<span class="built_in">ord</span>(char) - base + shift) % <span class="number">26</span> + base)</span><br><span class="line">            encrypted += new_char</span><br><span class="line">            shift += <span class="number">3</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            encrypted += char</span><br><span class="line">    <span class="keyword">return</span> encrypted</span><br><span class="line"></span><br><span class="line"><span class="comment"># KXKET&#123;Tubsdx_re_hg_zytc_hxq_vnjma&#125;</span></span><br></pre></td></tr></table></figure></div>

<p>是简单的凯撒编码，直接在原来基础上编写<code>decrypt</code>函数：</p>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">variant_caesar_decrypt</span>(<span class="params">ciphertext</span>):</span><br><span class="line">    decrypted = <span class="string">&quot;&quot;</span></span><br><span class="line">    shift = <span class="number">2</span></span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> ciphertext:</span><br><span class="line">        <span class="keyword">if</span> char.isalpha():</span><br><span class="line">            <span class="keyword">if</span> char.isupper():</span><br><span class="line">                base = <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line">                original_char = <span class="built_in">chr</span>((<span class="built_in">ord</span>(char) - base - shift) % <span class="number">26</span> + base)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                base = <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">                original_char = <span class="built_in">chr</span>((<span class="built_in">ord</span>(char) - base - shift) % <span class="number">26</span> + base)</span><br><span class="line">            decrypted += original_char</span><br><span class="line">            shift += <span class="number">3</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            decrypted += char</span><br><span class="line">    <span class="keyword">return</span> decrypted</span><br><span class="line"></span><br><span class="line">ciphertext = <span class="string">&quot;KXKET&#123;Tubsdx_re_hg_zytc_hxq_vnjma&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(variant_caesar_decrypt(ciphertext))</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag:ISCTF&#123;Caesar_is_so_easy_and_funny&#125;</span></span><br></pre></td></tr></table></figure></div>



<h4 id="小蓝鲨的RC4系统"><a href="#小蓝鲨的RC4系统" class="headerlink" title="小蓝鲨的RC4系统"></a>小蓝鲨的RC4系统</h4><hr>
<p>题目描述：送都送了，再给一个。</p>
<hr>
<p>下载附件：</p>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">StreamCipher</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, key</span>):</span><br><span class="line">    </span><br><span class="line">        <span class="variable language_">self</span>.S = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">        <span class="variable language_">self</span>.i = <span class="number">0</span></span><br><span class="line">        <span class="variable language_">self</span>.j = <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        j = <span class="number">0</span></span><br><span class="line">        key_bytes = <span class="variable language_">self</span>._key_to_bytes(key)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">            j = (j + <span class="variable language_">self</span>.S[i] + key_bytes[i % <span class="built_in">len</span>(key_bytes)]) % <span class="number">256</span></span><br><span class="line">            <span class="variable language_">self</span>.S[i], <span class="variable language_">self</span>.S[j] = <span class="variable language_">self</span>.S[j], <span class="variable language_">self</span>.S[i]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_key_to_bytes</span>(<span class="params">self, key</span>):</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(key, <span class="built_in">str</span>):</span><br><span class="line">            <span class="keyword">return</span> hashlib.sha256(key.encode()).digest()</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">isinstance</span>(key, <span class="built_in">bytes</span>):</span><br><span class="line">            <span class="keyword">return</span> hashlib.sha256(key).digest()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_prga</span>(<span class="params">self</span>):</span><br><span class="line">        </span><br><span class="line">        <span class="variable language_">self</span>.i = (<span class="variable language_">self</span>.i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        <span class="variable language_">self</span>.j = (<span class="variable language_">self</span>.j + <span class="variable language_">self</span>.S[<span class="variable language_">self</span>.i]) % <span class="number">256</span></span><br><span class="line">        <span class="variable language_">self</span>.S[<span class="variable language_">self</span>.i], <span class="variable language_">self</span>.S[<span class="variable language_">self</span>.j] = <span class="variable language_">self</span>.S[<span class="variable language_">self</span>.j], <span class="variable language_">self</span>.S[<span class="variable language_">self</span>.i]</span><br><span class="line">        K = <span class="variable language_">self</span>.S[(<span class="variable language_">self</span>.S[<span class="variable language_">self</span>.i] + <span class="variable language_">self</span>.S[<span class="variable language_">self</span>.j]) % <span class="number">256</span>]</span><br><span class="line">        <span class="keyword">return</span> K</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">crypt</span>(<span class="params">self, data</span>):</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(data, <span class="built_in">str</span>):</span><br><span class="line">            data = data.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">        result = <span class="built_in">bytearray</span>()</span><br><span class="line">        <span class="keyword">for</span> byte <span class="keyword">in</span> data:</span><br><span class="line">            key_byte = <span class="variable language_">self</span>._prga()</span><br><span class="line">            result.append(byte ^ key_byte)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">bytes</span>(result)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_string</span>(<span class="params">text, key</span>):</span><br><span class="line">    </span><br><span class="line">    cipher = StreamCipher(key)</span><br><span class="line">    encrypted = cipher.crypt(text)</span><br><span class="line">    <span class="keyword">return</span> encrypted.<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">#ISCTF2025</span></span><br><span class="line"><span class="comment">#ba19a7116763ba8ba1c236c6bdc30187dcc8afb28c8fa5f266763880b74f5fff915613718f4d19c3baf4bbe24bd57303ce103d</span></span><br></pre></td></tr></table></figure></div>

<p>得到是RC4<strong>流密码</strong>加密，</p>
<p>RC4的<code>加密和解密用的为同一个函数(异或操作为自反的)</code>，所以解密只需<code>把密文从十六进制转成字节</code>，再调用<code>crypt</code>，</p>
<p>exp：</p>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">StreamCipher</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, key</span>):</span><br><span class="line">        <span class="variable language_">self</span>.S = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">        <span class="variable language_">self</span>.i = <span class="number">0</span></span><br><span class="line">        <span class="variable language_">self</span>.j = <span class="number">0</span></span><br><span class="line">        j = <span class="number">0</span></span><br><span class="line">        key_bytes = <span class="variable language_">self</span>._key_to_bytes(key)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">            j = (j + <span class="variable language_">self</span>.S[i] + key_bytes[i % <span class="built_in">len</span>(key_bytes)]) % <span class="number">256</span></span><br><span class="line">            <span class="variable language_">self</span>.S[i], <span class="variable language_">self</span>.S[j] = <span class="variable language_">self</span>.S[j], <span class="variable language_">self</span>.S[i]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_key_to_bytes</span>(<span class="params">self, key</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(key, <span class="built_in">str</span>):</span><br><span class="line">            <span class="keyword">return</span> hashlib.sha256(key.encode()).digest()</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">isinstance</span>(key, <span class="built_in">bytes</span>):</span><br><span class="line">            <span class="keyword">return</span> hashlib.sha256(key).digest()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_prga</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.i = (<span class="variable language_">self</span>.i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        <span class="variable language_">self</span>.j = (<span class="variable language_">self</span>.j + <span class="variable language_">self</span>.S[<span class="variable language_">self</span>.i]) % <span class="number">256</span></span><br><span class="line">        <span class="variable language_">self</span>.S[<span class="variable language_">self</span>.i], <span class="variable language_">self</span>.S[<span class="variable language_">self</span>.j] = <span class="variable language_">self</span>.S[<span class="variable language_">self</span>.j], <span class="variable language_">self</span>.S[<span class="variable language_">self</span>.i]</span><br><span class="line">        K = <span class="variable language_">self</span>.S[(<span class="variable language_">self</span>.S[<span class="variable language_">self</span>.i] + <span class="variable language_">self</span>.S[<span class="variable language_">self</span>.j]) % <span class="number">256</span>]</span><br><span class="line">        <span class="keyword">return</span> K</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">crypt</span>(<span class="params">self, data</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(data, <span class="built_in">str</span>):</span><br><span class="line">            data = data.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        result = <span class="built_in">bytearray</span>()</span><br><span class="line">        <span class="keyword">for</span> byte <span class="keyword">in</span> data:</span><br><span class="line">            key_byte = <span class="variable language_">self</span>._prga()</span><br><span class="line">            result.append(byte ^ key_byte)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">bytes</span>(result)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_hex</span>(<span class="params">hex_data, key</span>):</span><br><span class="line">    ciphertext_bytes = <span class="built_in">bytes</span>.fromhex(hex_data)</span><br><span class="line">    cipher = StreamCipher(key)</span><br><span class="line">    decrypted_bytes = cipher.crypt(ciphertext_bytes)</span><br><span class="line">    <span class="keyword">return</span> decrypted_bytes.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    hex_data = <span class="string">&quot;ba19a7116763ba8ba1c236c6bdc30187dcc8afb28c8fa5f266763880b74f5fff915613718f4d19c3baf4bbe24bd57303ce103d&quot;</span></span><br><span class="line">    key = <span class="string">&quot;ISCTF2025&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(decrypt_hex(hex_data, key)) </span><br><span class="line">    </span><br><span class="line"><span class="comment">#flag: ISCTF&#123;Welcome_to_ISCTF_&amp;_this_is_a_secret_with_RC4&#125;</span></span><br></pre></td></tr></table></figure></div>



<h3 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h3><h4 id="Guess！"><a href="#Guess！" class="headerlink" title="Guess！"></a>Guess！</h4><hr>
<p>题目描述：这是一个经典的猜数字，开始你的数字解密之旅吧！</p>
<hr>
<p>下载附件，是pyinstaller处理后的<code>MiscNumberChallenge.exe</code>，用<code>unpack.py</code>解包后得到<code>extracted</code>目录</p>
<p>找到<code>misc_challenge.pyc</code>文件，在 <a class="link"   target="_blank" rel="noopener" href="https://pylingual.io/" >https://pylingual.io/<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a> 反编译.pyc文件：</p>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode_flag</span>(<span class="params">encoded_flag</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;解码隐藏的Flag&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        decoded = base64.b64decode(encoded_flag).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        decoded = base64.b64decode(decoded).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> decoded</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Flag解码错误&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    secret_number = random.randint(<span class="number">1</span>, <span class="number">100</span>)</span><br><span class="line">    max_attempts = <span class="number">10</span></span><br><span class="line">    encoded_flag = <span class="string">&#x27;SVNDVEZ7OXVlU3NfdGhFX0BuJHdlUn0=&#x27;</span></span><br><span class="line">    encoded_flag = base64.b64encode(encoded_flag.encode()).decode()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;==================================================&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;欢迎参加Misc猜数字挑战！&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;系统已生成1-100之间的秘密数字，你有<span class="subst">&#123;max_attempts&#125;</span>次机会&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;猜对数字即可获得Flag!&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;==================================================&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> attempt <span class="keyword">in</span> <span class="built_in">range</span>(max_attempts):</span><br><span class="line">        remaining = max_attempts - attempt</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;\n[剩余机会: <span class="subst">&#123;remaining&#125;</span>]&#x27;</span>)</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                guess = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;请输入你的猜测 (1-100): &#x27;</span>))</span><br><span class="line">                <span class="keyword">if</span> <span class="number">1</span> &lt;= guess &lt;= <span class="number">100</span>:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;请输入1-100之间的整数！&#x27;</span>)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;无效输入！请输入整数。&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> guess &lt; secret_number:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;guess&#125;</span> → 太小了，继续努力！&#x27;</span>)</span><br><span class="line">        <span class="keyword">elif</span> guess &gt; secret_number:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;guess&#125;</span> → 太大了，往小试试！&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;==================================================&#x27;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;★ 恭喜！你猜对了！数字就是 <span class="subst">&#123;secret_number&#125;</span>&#x27;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;★ 恭喜获得Flag:&#x27;</span>)</span><br><span class="line">            flag = decode_flag(encoded_flag)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;★ <span class="subst">&#123;flag&#125;</span>&#x27;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;==================================================&#x27;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;程序将在10秒后关闭...&#x27;</span>)</span><br><span class="line">            time.sleep(<span class="number">10</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;\n==================================================&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;⚠️ 挑战失败！&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;⚠️ 正确答案是: <span class="subst">&#123;secret_number&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;⚠️ 请重新运行程序再次尝试！&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;==================================================&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;程序将在10秒后关闭...&#x27;</span>)</span><br><span class="line">        time.sleep(<span class="number">10</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        main()</span><br><span class="line">    <span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;\n\n程序已中断。&#x27;</span>)</span><br><span class="line">        sys.exit()</span><br></pre></td></tr></table></figure></div>

<p>容易得到，flag编码为<code>base64</code>，解码即得flag：ISCTF{9ueSs_thE_@n$weR}</p>
<h3 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h3><h4 id="ezzz-math"><a href="#ezzz-math" class="headerlink" title="ezzz_math"></a>ezzz_math</h4><hr>
<p>题目描述：来解方程吧</p>
<hr>
<p>IDA中打开，可疑点<code>_main</code>函数：</p>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="built_in">int</span> i; // [esp+4h] [ebp-6Ch]</span><br><span class="line">  char Str[<span class="number">100</span>]; // [esp+8h] [ebp-68h] BYREF</span><br><span class="line"></span><br><span class="line">  sub_403B50(aPleaseInputYou);</span><br><span class="line">  sub_403B50(aTryToUseZ3Solv);</span><br><span class="line">  sub_403B90(<span class="string">&quot;%80s&quot;</span>, Str);</span><br><span class="line">  <span class="keyword">if</span> ( strlen(Str) == <span class="number">23</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">23</span>; ++i )</span><br><span class="line">      Str[i] ^= 0xCu;</span><br><span class="line">    <span class="keyword">if</span> ( sub_401000(Str) )</span><br><span class="line">      puts(aRight);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      puts(aWrong);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    puts(Buffer);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>逻辑就是输入<code>23字节</code>字符串，用<code>0xC(12)</code>异或，最后将异或完的数组传给<code>sub_401000</code>验证。</p>
<p>所以，我们看向<code>sub_401000</code>函数：</p>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line">BOOL __cdecl sub_401000(char *a1)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">94</span> * a1[<span class="number">22</span>]</span><br><span class="line">       + <span class="number">74</span> * a1[<span class="number">21</span>]</span><br><span class="line">       + <span class="number">70</span> * a1[<span class="number">19</span>]</span><br><span class="line">       + <span class="number">12</span> * a1[<span class="number">18</span>]</span><br><span class="line">       + <span class="number">20</span> * a1[<span class="number">16</span>]</span><br><span class="line">       + <span class="number">62</span> * a1[<span class="number">12</span>]</span><br><span class="line">       + <span class="number">82</span> * a1[<span class="number">10</span>]</span><br><span class="line">       + <span class="number">7</span> * a1[<span class="number">7</span>]</span><br><span class="line">       + <span class="number">63</span> * a1[<span class="number">6</span>]</span><br><span class="line">       + <span class="number">18</span> * a1[<span class="number">5</span>]</span><br><span class="line">       + <span class="number">58</span> * a1[<span class="number">4</span>]</span><br><span class="line">       + <span class="number">94</span> * a1[<span class="number">2</span>]</span><br><span class="line">       + <span class="number">77</span> * *a1</span><br><span class="line">       - <span class="number">43</span> * a1[<span class="number">1</span>]</span><br><span class="line">       - <span class="number">37</span> * a1[<span class="number">3</span>]</span><br><span class="line">       - <span class="number">97</span> * a1[<span class="number">8</span>]</span><br><span class="line">       - <span class="number">23</span> * a1[<span class="number">9</span>]</span><br><span class="line">       - <span class="number">86</span> * a1[<span class="number">11</span>]</span><br><span class="line">       - <span class="number">6</span> * a1[<span class="number">13</span>]</span><br><span class="line">       - <span class="number">5</span> * a1[<span class="number">14</span>]</span><br><span class="line">       - <span class="number">79</span> * a1[<span class="number">15</span>]</span><br><span class="line">       - <span class="number">63</span> * a1[<span class="number">17</span>]</span><br><span class="line">       - <span class="number">93</span> * a1[<span class="number">20</span>] == <span class="number">20156</span></span><br><span class="line">      &amp;&amp; <span class="number">87</span> * a1[<span class="number">22</span>]</span><br><span class="line">       + <span class="number">75</span> * a1[<span class="number">21</span>]</span><br><span class="line">       + <span class="number">73</span> * a1[<span class="number">15</span>]</span><br><span class="line">       + <span class="number">67</span> * a1[<span class="number">14</span>]</span><br><span class="line">       + <span class="number">30</span> * a1[<span class="number">13</span>]</span><br><span class="line">       + (a1[<span class="number">11</span>] &lt;&lt; <span class="number">6</span>)</span><br><span class="line">       + <span class="number">35</span> * a1[<span class="number">9</span>]</span><br><span class="line">       + <span class="number">91</span> * a1[<span class="number">7</span>]</span><br><span class="line">       + <span class="number">91</span> * a1[<span class="number">5</span>]</span><br><span class="line">       + <span class="number">34</span> * a1[<span class="number">3</span>]</span><br><span class="line">       + <span class="number">74</span> * *a1</span><br><span class="line">       - <span class="number">89</span> * a1[<span class="number">1</span>]</span><br><span class="line">       - <span class="number">72</span> * a1[<span class="number">2</span>]</span><br><span class="line">       - <span class="number">76</span> * a1[<span class="number">4</span>]</span><br><span class="line">       - <span class="number">32</span> * a1[<span class="number">6</span>]</span><br><span class="line">       - <span class="number">97</span> * a1[<span class="number">8</span>]</span><br><span class="line">       - <span class="number">39</span> * a1[<span class="number">10</span>]</span><br><span class="line">       - <span class="number">23</span> * a1[<span class="number">12</span>]</span><br><span class="line">       + <span class="number">8</span> * a1[<span class="number">16</span>]</span><br><span class="line">       - <span class="number">98</span> * a1[<span class="number">17</span>]</span><br><span class="line">       - <span class="number">4</span> * a1[<span class="number">18</span>]</span><br><span class="line">       - <span class="number">80</span> * a1[<span class="number">19</span>]</span><br><span class="line">       - <span class="number">83</span> * a1[<span class="number">20</span>] == <span class="number">7183</span></span><br><span class="line">      &amp;&amp; <span class="number">51</span> * a1[<span class="number">21</span>]</span><br><span class="line">       + <span class="number">22</span> * a1[<span class="number">20</span>]</span><br><span class="line">       + <span class="number">15</span> * a1[<span class="number">19</span>]</span><br><span class="line">       + <span class="number">51</span> * a1[<span class="number">17</span>]</span><br><span class="line">       + <span class="number">96</span> * a1[<span class="number">12</span>]</span><br><span class="line">       + <span class="number">34</span> * a1[<span class="number">7</span>]</span><br><span class="line">       + <span class="number">77</span> * a1[<span class="number">5</span>]</span><br><span class="line">       + <span class="number">59</span> * a1[<span class="number">2</span>]</span><br><span class="line">       + <span class="number">89</span> * a1[<span class="number">1</span>]</span><br><span class="line">       + <span class="number">92</span> * *a1</span><br><span class="line">       - <span class="number">85</span> * a1[<span class="number">3</span>]</span><br><span class="line">       - <span class="number">50</span> * a1[<span class="number">4</span>]</span><br><span class="line">       - <span class="number">51</span> * a1[<span class="number">6</span>]</span><br><span class="line">       - <span class="number">75</span> * a1[<span class="number">8</span>]</span><br><span class="line">       - <span class="number">40</span> * a1[<span class="number">10</span>]</span><br><span class="line">       - <span class="number">4</span> * a1[<span class="number">11</span>]</span><br><span class="line">       - <span class="number">74</span> * a1[<span class="number">13</span>]</span><br><span class="line">       - <span class="number">98</span> * a1[<span class="number">14</span>]</span><br><span class="line">       - <span class="number">23</span> * a1[<span class="number">15</span>]</span><br><span class="line">       - <span class="number">14</span> * a1[<span class="number">16</span>]</span><br><span class="line">       - <span class="number">92</span> * a1[<span class="number">18</span>]</span><br><span class="line">       - <span class="number">7</span> * a1[<span class="number">22</span>] == -<span class="number">7388</span></span><br><span class="line">      &amp;&amp; <span class="number">61</span> * a1[<span class="number">22</span>]</span><br><span class="line">       + <span class="number">72</span> * a1[<span class="number">21</span>]</span><br><span class="line">       + <span class="number">28</span> * a1[<span class="number">20</span>]</span><br><span class="line">       + <span class="number">55</span> * a1[<span class="number">18</span>]</span><br><span class="line">       + <span class="number">20</span> * a1[<span class="number">17</span>]</span><br><span class="line">       + <span class="number">13</span> * a1[<span class="number">14</span>]</span><br><span class="line">       + <span class="number">51</span> * a1[<span class="number">13</span>]</span><br><span class="line">       + <span class="number">69</span> * a1[<span class="number">12</span>]</span><br><span class="line">       + <span class="number">10</span> * a1[<span class="number">11</span>]</span><br><span class="line">       + <span class="number">95</span> * a1[<span class="number">10</span>]</span><br><span class="line">       + <span class="number">43</span> * a1[<span class="number">9</span>]</span><br><span class="line">       + <span class="number">53</span> * a1[<span class="number">8</span>]</span><br><span class="line">       + <span class="number">76</span> * a1[<span class="number">7</span>]</span><br><span class="line">       + <span class="number">25</span> * a1[<span class="number">6</span>]</span><br><span class="line">       + <span class="number">9</span> * a1[<span class="number">5</span>]</span><br><span class="line">       + <span class="number">10</span> * a1[<span class="number">4</span>]</span><br><span class="line">       + <span class="number">98</span> * a1[<span class="number">1</span>]</span><br><span class="line">       + <span class="number">70</span> * *a1</span><br><span class="line">       - <span class="number">22</span> * a1[<span class="number">2</span>]</span><br><span class="line">       + <span class="number">2</span> * a1[<span class="number">3</span>]</span><br><span class="line">       - <span class="number">49</span> * a1[<span class="number">15</span>]</span><br><span class="line">       + <span class="number">4</span> * a1[<span class="number">16</span>]</span><br><span class="line">       - <span class="number">77</span> * a1[<span class="number">19</span>] == <span class="number">69057</span></span><br><span class="line">      &amp;&amp; <span class="number">7</span> * a1[<span class="number">22</span>]</span><br><span class="line">       + <span class="number">21</span> * a1[<span class="number">16</span>]</span><br><span class="line">       + <span class="number">22</span> * a1[<span class="number">13</span>]</span><br><span class="line">       + <span class="number">55</span> * a1[<span class="number">9</span>]</span><br><span class="line">       + <span class="number">66</span> * a1[<span class="number">8</span>]</span><br><span class="line">       + <span class="number">78</span> * a1[<span class="number">5</span>]</span><br><span class="line">       + <span class="number">10</span> * a1[<span class="number">3</span>]</span><br><span class="line">       + <span class="number">80</span> * a1[<span class="number">1</span>]</span><br><span class="line">       + <span class="number">65</span> * *a1</span><br><span class="line">       - <span class="number">20</span> * a1[<span class="number">2</span>]</span><br><span class="line">       - <span class="number">53</span> * a1[<span class="number">4</span>]</span><br><span class="line">       - <span class="number">98</span> * a1[<span class="number">6</span>]</span><br><span class="line">       + <span class="number">8</span> * a1[<span class="number">7</span>]</span><br><span class="line">       - <span class="number">78</span> * a1[<span class="number">10</span>]</span><br><span class="line">       - <span class="number">94</span> * a1[<span class="number">11</span>]</span><br><span class="line">       - <span class="number">93</span> * a1[<span class="number">12</span>]</span><br><span class="line">       - <span class="number">18</span> * a1[<span class="number">14</span>]</span><br><span class="line">       - <span class="number">48</span> * a1[<span class="number">15</span>]</span><br><span class="line">       - <span class="number">9</span> * a1[<span class="number">17</span>]</span><br><span class="line">       - <span class="number">73</span> * a1[<span class="number">18</span>]</span><br><span class="line">       - <span class="number">59</span> * a1[<span class="number">19</span>]</span><br><span class="line">       - <span class="number">68</span> * a1[<span class="number">20</span>]</span><br><span class="line">       - <span class="number">74</span> * a1[<span class="number">21</span>] == -<span class="number">31438</span></span><br><span class="line">      &amp;&amp; <span class="number">33</span> * a1[<span class="number">19</span>]</span><br><span class="line">       + <span class="number">78</span> * a1[<span class="number">15</span>]</span><br><span class="line">       + <span class="number">66</span> * a1[<span class="number">10</span>]</span><br><span class="line">       + <span class="number">3</span> * a1[<span class="number">9</span>]</span><br><span class="line">       + <span class="number">43</span> * a1[<span class="number">4</span>]</span><br><span class="line">       + <span class="number">24</span> * a1[<span class="number">3</span>]</span><br><span class="line">       + <span class="number">3</span> * a1[<span class="number">2</span>]</span><br><span class="line">       + <span class="number">27</span> * *a1</span><br><span class="line">       - <span class="number">18</span> * a1[<span class="number">1</span>]</span><br><span class="line">       - <span class="number">46</span> * a1[<span class="number">5</span>]</span><br><span class="line">       - <span class="number">18</span> * a1[<span class="number">6</span>]</span><br><span class="line">       - a1[<span class="number">7</span>]</span><br><span class="line">       - <span class="number">33</span> * a1[<span class="number">8</span>]</span><br><span class="line">       - <span class="number">50</span> * a1[<span class="number">11</span>]</span><br><span class="line">       - <span class="number">23</span> * a1[<span class="number">12</span>]</span><br><span class="line">       - <span class="number">37</span> * a1[<span class="number">13</span>]</span><br><span class="line">       - <span class="number">45</span> * a1[<span class="number">14</span>]</span><br><span class="line">       + <span class="number">2</span> * a1[<span class="number">16</span>]</span><br><span class="line">       - a1[<span class="number">17</span>]</span><br><span class="line">       - <span class="number">60</span> * a1[<span class="number">18</span>]</span><br><span class="line">       - <span class="number">87</span> * a1[<span class="number">20</span>]</span><br><span class="line">       - <span class="number">72</span> * a1[<span class="number">21</span>]</span><br><span class="line">       - <span class="number">6</span> * a1[<span class="number">22</span>] == -<span class="number">26121</span></span><br><span class="line">      &amp;&amp; <span class="number">31</span> * a1[<span class="number">20</span>]</span><br><span class="line">       + <span class="number">80</span> * a1[<span class="number">18</span>]</span><br><span class="line">       + <span class="number">34</span> * a1[<span class="number">17</span>]</span><br><span class="line">       + <span class="number">34</span> * a1[<span class="number">15</span>]</span><br><span class="line">       + <span class="number">38</span> * a1[<span class="number">14</span>]</span><br><span class="line">       + <span class="number">53</span> * a1[<span class="number">13</span>]</span><br><span class="line">       + <span class="number">35</span> * a1[<span class="number">12</span>]</span><br><span class="line">       + <span class="number">82</span> * a1[<span class="number">9</span>]</span><br><span class="line">       + <span class="number">27</span> * a1[<span class="number">8</span>]</span><br><span class="line">       + <span class="number">80</span> * a1[<span class="number">7</span>]</span><br><span class="line">       + <span class="number">46</span> * a1[<span class="number">6</span>]</span><br><span class="line">       + <span class="number">18</span> * a1[<span class="number">4</span>]</span><br><span class="line">       + <span class="number">5</span> * a1[<span class="number">1</span>]</span><br><span class="line">       + <span class="number">98</span> * *a1</span><br><span class="line">       - <span class="number">12</span> * a1[<span class="number">2</span>]</span><br><span class="line">       - <span class="number">9</span> * a1[<span class="number">3</span>]</span><br><span class="line">       - <span class="number">57</span> * a1[<span class="number">5</span>]</span><br><span class="line">       - <span class="number">46</span> * a1[<span class="number">10</span>]</span><br><span class="line">       - <span class="number">31</span> * a1[<span class="number">11</span>]</span><br><span class="line">       - <span class="number">68</span> * a1[<span class="number">16</span>]</span><br><span class="line">       - <span class="number">94</span> * a1[<span class="number">19</span>]</span><br><span class="line">       - <span class="number">93</span> * a1[<span class="number">21</span>]</span><br><span class="line">       - <span class="number">15</span> * a1[<span class="number">22</span>] == <span class="number">26005</span></span><br><span class="line">      &amp;&amp; <span class="number">81</span> * a1[<span class="number">21</span>]</span><br><span class="line">       + <span class="number">40</span> * a1[<span class="number">20</span>]</span><br><span class="line">       + <span class="number">34</span> * a1[<span class="number">19</span>]</span><br><span class="line">       + <span class="number">94</span> * a1[<span class="number">18</span>]</span><br><span class="line">       + <span class="number">98</span> * a1[<span class="number">17</span>]</span><br><span class="line">       + <span class="number">11</span> * a1[<span class="number">14</span>]</span><br><span class="line">       + <span class="number">63</span> * a1[<span class="number">13</span>]</span><br><span class="line">       + <span class="number">95</span> * a1[<span class="number">12</span>]</span><br><span class="line">       + <span class="number">43</span> * a1[<span class="number">11</span>]</span><br><span class="line">       + <span class="number">99</span> * a1[<span class="number">10</span>]</span><br><span class="line">       + <span class="number">29</span> * a1[<span class="number">9</span>]</span><br><span class="line">       + <span class="number">81</span> * a1[<span class="number">6</span>]</span><br><span class="line">       + <span class="number">72</span> * a1[<span class="number">5</span>]</span><br><span class="line">       + <span class="number">54</span> * a1[<span class="number">3</span>]</span><br><span class="line">       + <span class="number">21</span> * *a1</span><br><span class="line">       - <span class="number">26</span> * a1[<span class="number">1</span>]</span><br><span class="line">       - <span class="number">90</span> * a1[<span class="number">2</span>]</span><br><span class="line">       - <span class="number">15</span> * a1[<span class="number">4</span>]</span><br><span class="line">       - <span class="number">54</span> * a1[<span class="number">7</span>]</span><br><span class="line">       - <span class="number">12</span> * a1[<span class="number">8</span>]</span><br><span class="line">       - <span class="number">38</span> * a1[<span class="number">15</span>]</span><br><span class="line">       - <span class="number">15</span> * a1[<span class="number">16</span>]</span><br><span class="line">       - <span class="number">56</span> * a1[<span class="number">22</span>] == <span class="number">57169</span></span><br><span class="line">      &amp;&amp; <span class="number">71</span> * a1[<span class="number">18</span>]</span><br><span class="line">       + <span class="number">39</span> * a1[<span class="number">17</span>]</span><br><span class="line">       + <span class="number">73</span> * a1[<span class="number">15</span>]</span><br><span class="line">       + <span class="number">14</span> * a1[<span class="number">14</span>]</span><br><span class="line">       + <span class="number">56</span> * a1[<span class="number">12</span>]</span><br><span class="line">       + <span class="number">56</span> * a1[<span class="number">10</span>]</span><br><span class="line">       + <span class="number">27</span> * a1[<span class="number">9</span>]</span><br><span class="line">       + <span class="number">68</span> * a1[<span class="number">7</span>]</span><br><span class="line">       + <span class="number">39</span> * a1[<span class="number">6</span>]</span><br><span class="line">       + <span class="number">26</span> * a1[<span class="number">5</span>]</span><br><span class="line">       + <span class="number">40</span> * a1[<span class="number">4</span>]</span><br><span class="line">       + <span class="number">24</span> * a1[<span class="number">3</span>]</span><br><span class="line">       + <span class="number">11</span> * a1[<span class="number">2</span>]</span><br><span class="line">       + <span class="number">14</span> * a1[<span class="number">1</span>]</span><br><span class="line">       + <span class="number">94</span> * *a1</span><br><span class="line">       - <span class="number">10</span> * a1[<span class="number">8</span>]</span><br><span class="line">       - <span class="number">11</span> * a1[<span class="number">11</span>]</span><br><span class="line">       - <span class="number">63</span> * a1[<span class="number">13</span>]</span><br><span class="line">       - <span class="number">39</span> * a1[<span class="number">16</span>]</span><br><span class="line">       - <span class="number">14</span> * a1[<span class="number">19</span>]</span><br><span class="line">       - <span class="number">17</span> * a1[<span class="number">20</span>]</span><br><span class="line">       - <span class="number">23</span> * a1[<span class="number">21</span>]</span><br><span class="line">       - <span class="number">7</span> * a1[<span class="number">22</span>] == <span class="number">40024</span></span><br><span class="line">      &amp;&amp; (a1[<span class="number">22</span>] &lt;&lt; <span class="number">6</span>)</span><br><span class="line">       + <span class="number">80</span> * a1[<span class="number">21</span>]</span><br><span class="line">       + <span class="number">89</span> * a1[<span class="number">20</span>]</span><br><span class="line">       + <span class="number">70</span> * a1[<span class="number">19</span>]</span><br><span class="line">       + <span class="number">66</span> * a1[<span class="number">18</span>]</span><br><span class="line">       + <span class="number">55</span> * a1[<span class="number">17</span>]</span><br><span class="line">       + <span class="number">16</span> * a1[<span class="number">16</span>]</span><br><span class="line">       + <span class="number">84</span> * a1[<span class="number">13</span>]</span><br><span class="line">       + <span class="number">48</span> * a1[<span class="number">12</span>]</span><br><span class="line">       + <span class="number">11</span> * a1[<span class="number">7</span>]</span><br><span class="line">       + <span class="number">32</span> * a1[<span class="number">5</span>]</span><br><span class="line">       + <span class="number">99</span> * *a1</span><br><span class="line">       - <span class="number">26</span> * a1[<span class="number">1</span>]</span><br><span class="line">       - <span class="number">91</span> * a1[<span class="number">2</span>]</span><br><span class="line">       - <span class="number">96</span> * a1[<span class="number">3</span>]</span><br><span class="line">       - <span class="number">63</span> * a1[<span class="number">4</span>]</span><br><span class="line">       - <span class="number">67</span> * a1[<span class="number">6</span>]</span><br><span class="line">       - <span class="number">72</span> * a1[<span class="number">8</span>]</span><br><span class="line">       + <span class="number">4</span> * a1[<span class="number">9</span>]</span><br><span class="line">       - <span class="number">84</span> * a1[<span class="number">10</span>]</span><br><span class="line">       - <span class="number">81</span> * a1[<span class="number">11</span>]</span><br><span class="line">       - <span class="number">80</span> * a1[<span class="number">14</span>]</span><br><span class="line">       - <span class="number">98</span> * a1[<span class="number">15</span>] == <span class="number">432</span></span><br><span class="line">      &amp;&amp; a1[<span class="number">21</span>]</span><br><span class="line">       + <span class="number">41</span> * a1[<span class="number">17</span>]</span><br><span class="line">       + <span class="number">46</span> * a1[<span class="number">12</span>]</span><br><span class="line">       + <span class="number">44</span> * a1[<span class="number">9</span>]</span><br><span class="line">       + <span class="number">63</span> * *a1</span><br><span class="line">       - <span class="number">73</span> * a1[<span class="number">1</span>]</span><br><span class="line">       - <span class="number">43</span> * a1[<span class="number">2</span>]</span><br><span class="line">       + <span class="number">4</span> * a1[<span class="number">3</span>]</span><br><span class="line">       - <span class="number">37</span> * a1[<span class="number">4</span>]</span><br><span class="line">       - <span class="number">54</span> * a1[<span class="number">5</span>]</span><br><span class="line">       - <span class="number">58</span> * a1[<span class="number">6</span>]</span><br><span class="line">       - <span class="number">95</span> * a1[<span class="number">7</span>]</span><br><span class="line">       - <span class="number">2</span> * a1[<span class="number">8</span>]</span><br><span class="line">       - <span class="number">37</span> * a1[<span class="number">10</span>]</span><br><span class="line">       - <span class="number">5</span> * a1[<span class="number">11</span>]</span><br><span class="line">       + <span class="number">2</span> * a1[<span class="number">13</span>]</span><br><span class="line">       - <span class="number">46</span> * a1[<span class="number">14</span>]</span><br><span class="line">       - <span class="number">27</span> * a1[<span class="number">15</span>]</span><br><span class="line">       - <span class="number">19</span> * a1[<span class="number">16</span>]</span><br><span class="line">       - <span class="number">78</span> * a1[<span class="number">18</span>]</span><br><span class="line">       - <span class="number">51</span> * a1[<span class="number">19</span>]</span><br><span class="line">       - <span class="number">82</span> * a1[<span class="number">20</span>]</span><br><span class="line">       - <span class="number">59</span> * a1[<span class="number">22</span>] == -<span class="number">57338</span></span><br><span class="line">      &amp;&amp; <span class="number">10</span> * a1[<span class="number">22</span>]</span><br><span class="line">       + <span class="number">58</span> * a1[<span class="number">18</span>]</span><br><span class="line">       + <span class="number">16</span> * a1[<span class="number">17</span>]</span><br><span class="line">       + <span class="number">69</span> * a1[<span class="number">16</span>]</span><br><span class="line">       + <span class="number">6</span> * a1[<span class="number">15</span>]</span><br><span class="line">       + <span class="number">5</span> * a1[<span class="number">12</span>]</span><br><span class="line">       + <span class="number">87</span> * a1[<span class="number">7</span>]</span><br><span class="line">       + <span class="number">47</span> * a1[<span class="number">5</span>]</span><br><span class="line">       + <span class="number">91</span> * a1[<span class="number">4</span>]</span><br><span class="line">       + <span class="number">54</span> * a1[<span class="number">2</span>]</span><br><span class="line">       + <span class="number">21</span> * a1[<span class="number">1</span>]</span><br><span class="line">       + <span class="number">52</span> * *a1</span><br><span class="line">       - <span class="number">76</span> * a1[<span class="number">3</span>]</span><br><span class="line">       - <span class="number">96</span> * a1[<span class="number">6</span>]</span><br><span class="line">       - <span class="number">27</span> * a1[<span class="number">8</span>]</span><br><span class="line">       - <span class="number">43</span> * a1[<span class="number">9</span>]</span><br><span class="line">       - <span class="number">15</span> * a1[<span class="number">10</span>]</span><br><span class="line">       - <span class="number">35</span> * a1[<span class="number">11</span>]</span><br><span class="line">       - <span class="number">53</span> * a1[<span class="number">13</span>]</span><br><span class="line">       + <span class="number">4</span> * a1[<span class="number">14</span>]</span><br><span class="line">       - <span class="number">83</span> * a1[<span class="number">19</span>]</span><br><span class="line">       - <span class="number">68</span> * a1[<span class="number">20</span>]</span><br><span class="line">       - <span class="number">18</span> * a1[<span class="number">21</span>] == <span class="number">1777</span></span><br><span class="line">      &amp;&amp; <span class="number">66</span> * a1[<span class="number">22</span>]</span><br><span class="line">       + <span class="number">92</span> * a1[<span class="number">21</span>]</span><br><span class="line">       + <span class="number">29</span> * a1[<span class="number">20</span>]</span><br><span class="line">       + <span class="number">42</span> * a1[<span class="number">19</span>]</span><br><span class="line">       + <span class="number">55</span> * a1[<span class="number">14</span>]</span><br><span class="line">       + <span class="number">72</span> * a1[<span class="number">13</span>]</span><br><span class="line">       + <span class="number">40</span> * a1[<span class="number">12</span>]</span><br><span class="line">       + <span class="number">31</span> * a1[<span class="number">10</span>]</span><br><span class="line">       + <span class="number">88</span> * a1[<span class="number">9</span>]</span><br><span class="line">       + <span class="number">61</span> * a1[<span class="number">8</span>]</span><br><span class="line">       + <span class="number">59</span> * a1[<span class="number">7</span>]</span><br><span class="line">       + <span class="number">35</span> * a1[<span class="number">6</span>]</span><br><span class="line">       + <span class="number">16</span> * a1[<span class="number">3</span>]</span><br><span class="line">       + <span class="number">24</span> * a1[<span class="number">1</span>]</span><br><span class="line">       + <span class="number">60</span> * *a1</span><br><span class="line">       - <span class="number">55</span> * a1[<span class="number">2</span>]</span><br><span class="line">       - <span class="number">8</span> * a1[<span class="number">4</span>]</span><br><span class="line">       - <span class="number">7</span> * a1[<span class="number">5</span>]</span><br><span class="line">       - <span class="number">17</span> * a1[<span class="number">11</span>]</span><br><span class="line">       - <span class="number">25</span> * a1[<span class="number">15</span>]</span><br><span class="line">       - <span class="number">22</span> * a1[<span class="number">16</span>]</span><br><span class="line">       - <span class="number">10</span> * a1[<span class="number">17</span>]</span><br><span class="line">       - <span class="number">59</span> * a1[<span class="number">18</span>] == <span class="number">47727</span></span><br><span class="line">      &amp;&amp; <span class="number">3</span> * a1[<span class="number">21</span>]</span><br><span class="line">       + <span class="number">54</span> * a1[<span class="number">18</span>]</span><br><span class="line">       + <span class="number">6</span> * a1[<span class="number">15</span>]</span><br><span class="line">       + <span class="number">93</span> * a1[<span class="number">14</span>]</span><br><span class="line">       + <span class="number">74</span> * a1[<span class="number">10</span>]</span><br><span class="line">       + <span class="number">6</span> * a1[<span class="number">7</span>]</span><br><span class="line">       + <span class="number">98</span> * a1[<span class="number">4</span>]</span><br><span class="line">       + <span class="number">65</span> * a1[<span class="number">3</span>]</span><br><span class="line">       + <span class="number">84</span> * a1[<span class="number">2</span>]</span><br><span class="line">       + <span class="number">18</span> * a1[<span class="number">1</span>]</span><br><span class="line">       + <span class="number">35</span> * *a1</span><br><span class="line">       - <span class="number">29</span> * a1[<span class="number">5</span>]</span><br><span class="line">       - <span class="number">40</span> * a1[<span class="number">6</span>]</span><br><span class="line">       - <span class="number">35</span> * a1[<span class="number">8</span>]</span><br><span class="line">       + <span class="number">8</span> * a1[<span class="number">9</span>]</span><br><span class="line">       - <span class="number">15</span> * a1[<span class="number">11</span>]</span><br><span class="line">       - <span class="number">4</span> * a1[<span class="number">12</span>]</span><br><span class="line">       - <span class="number">83</span> * a1[<span class="number">16</span>]</span><br><span class="line">       - <span class="number">74</span> * a1[<span class="number">17</span>]</span><br><span class="line">       - <span class="number">72</span> * a1[<span class="number">19</span>]</span><br><span class="line">       - <span class="number">53</span> * a1[<span class="number">20</span>]</span><br><span class="line">       - <span class="number">31</span> * a1[<span class="number">22</span>] == <span class="number">6695</span></span><br><span class="line">      &amp;&amp; <span class="number">45</span> * a1[<span class="number">20</span>]</span><br><span class="line">       + <span class="number">14</span> * a1[<span class="number">19</span>]</span><br><span class="line">       + <span class="number">76</span> * a1[<span class="number">18</span>]</span><br><span class="line">       + <span class="number">17</span> * a1[<span class="number">16</span>]</span><br><span class="line">       + <span class="number">86</span> * a1[<span class="number">14</span>]</span><br><span class="line">       + <span class="number">28</span> * a1[<span class="number">11</span>]</span><br><span class="line">       + <span class="number">19</span> * a1[<span class="number">5</span>]</span><br><span class="line">       + <span class="number">46</span> * a1[<span class="number">1</span>]</span><br><span class="line">       + <span class="number">75</span> * *a1</span><br><span class="line">       - <span class="number">12</span> * a1[<span class="number">2</span>]</span><br><span class="line">       - <span class="number">27</span> * a1[<span class="number">3</span>]</span><br><span class="line">       - <span class="number">66</span> * a1[<span class="number">4</span>]</span><br><span class="line">       - <span class="number">27</span> * a1[<span class="number">6</span>]</span><br><span class="line">       - <span class="number">32</span> * a1[<span class="number">7</span>]</span><br><span class="line">       - <span class="number">69</span> * a1[<span class="number">8</span>]</span><br><span class="line">       - <span class="number">31</span> * a1[<span class="number">9</span>]</span><br><span class="line">       - <span class="number">65</span> * a1[<span class="number">10</span>]</span><br><span class="line">       - <span class="number">54</span> * a1[<span class="number">12</span>]</span><br><span class="line">       - <span class="number">6</span> * a1[<span class="number">13</span>]</span><br><span class="line">       + <span class="number">2</span> * a1[<span class="number">15</span>]</span><br><span class="line">       - <span class="number">10</span> * a1[<span class="number">17</span>]</span><br><span class="line">       - <span class="number">89</span> * a1[<span class="number">21</span>]</span><br><span class="line">       - <span class="number">16</span> * a1[<span class="number">22</span>] == -<span class="number">3780</span></span><br><span class="line">      &amp;&amp; <span class="number">62</span> * a1[<span class="number">21</span>]</span><br><span class="line">       + <span class="number">74</span> * a1[<span class="number">20</span>]</span><br><span class="line">       + <span class="number">28</span> * a1[<span class="number">18</span>]</span><br><span class="line">       + <span class="number">7</span> * a1[<span class="number">17</span>]</span><br><span class="line">       + <span class="number">74</span> * a1[<span class="number">16</span>]</span><br><span class="line">       + <span class="number">45</span> * a1[<span class="number">15</span>]</span><br><span class="line">       + <span class="number">57</span> * a1[<span class="number">14</span>]</span><br><span class="line">       + <span class="number">34</span> * a1[<span class="number">11</span>]</span><br><span class="line">       + <span class="number">85</span> * a1[<span class="number">10</span>]</span><br><span class="line">       + <span class="number">98</span> * a1[<span class="number">6</span>]</span><br><span class="line">       + <span class="number">29</span> * a1[<span class="number">4</span>]</span><br><span class="line">       + <span class="number">94</span> * a1[<span class="number">3</span>]</span><br><span class="line">       + <span class="number">51</span> * a1[<span class="number">2</span>]</span><br><span class="line">       + <span class="number">85</span> * a1[<span class="number">1</span>]</span><br><span class="line">       - <span class="number">36</span> * a1[<span class="number">5</span>]</span><br><span class="line">       - a1[<span class="number">7</span>]</span><br><span class="line">       - <span class="number">3</span> * a1[<span class="number">8</span>]</span><br><span class="line">       - <span class="number">74</span> * a1[<span class="number">9</span>]</span><br><span class="line">       - <span class="number">70</span> * a1[<span class="number">12</span>]</span><br><span class="line">       - <span class="number">68</span> * a1[<span class="number">13</span>]</span><br><span class="line">       - <span class="number">3</span> * a1[<span class="number">19</span>]</span><br><span class="line">       + <span class="number">8</span> * a1[<span class="number">22</span>] == <span class="number">47300</span></span><br><span class="line">      &amp;&amp; <span class="number">22</span> * a1[<span class="number">22</span>]</span><br><span class="line">       + <span class="number">45</span> * a1[<span class="number">21</span>]</span><br><span class="line">       + <span class="number">14</span> * a1[<span class="number">19</span>]</span><br><span class="line">       + <span class="number">32</span> * a1[<span class="number">18</span>]</span><br><span class="line">       + <span class="number">77</span> * a1[<span class="number">17</span>]</span><br><span class="line">       + <span class="number">70</span> * a1[<span class="number">12</span>]</span><br><span class="line">       + <span class="number">7</span> * a1[<span class="number">10</span>]</span><br><span class="line">       + <span class="number">99</span> * a1[<span class="number">4</span>]</span><br><span class="line">       + <span class="number">82</span> * *a1</span><br><span class="line">       - <span class="number">48</span> * a1[<span class="number">1</span>]</span><br><span class="line">       - <span class="number">40</span> * a1[<span class="number">2</span>]</span><br><span class="line">       - <span class="number">81</span> * a1[<span class="number">3</span>]</span><br><span class="line">       - <span class="number">27</span> * a1[<span class="number">5</span>]</span><br><span class="line">       - <span class="number">75</span> * a1[<span class="number">6</span>]</span><br><span class="line">       - <span class="number">79</span> * a1[<span class="number">7</span>]</span><br><span class="line">       - <span class="number">26</span> * a1[<span class="number">8</span>]</span><br><span class="line">       - <span class="number">68</span> * a1[<span class="number">9</span>]</span><br><span class="line">       - <span class="number">57</span> * a1[<span class="number">11</span>]</span><br><span class="line">       - <span class="number">77</span> * a1[<span class="number">13</span>]</span><br><span class="line">       - <span class="number">32</span> * a1[<span class="number">14</span>]</span><br><span class="line">       - a1[<span class="number">15</span>]</span><br><span class="line">       - <span class="number">91</span> * a1[<span class="number">16</span>]</span><br><span class="line">       - <span class="number">14</span> * a1[<span class="number">20</span>] == -<span class="number">34153</span></span><br><span class="line">      &amp;&amp; <span class="number">65</span> * a1[<span class="number">21</span>]</span><br><span class="line">       + <span class="number">13</span> * a1[<span class="number">20</span>]</span><br><span class="line">       + <span class="number">61</span> * a1[<span class="number">17</span>]</span><br><span class="line">       + <span class="number">97</span> * a1[<span class="number">13</span>]</span><br><span class="line">       + <span class="number">24</span> * a1[<span class="number">10</span>]</span><br><span class="line">       + <span class="number">40</span> * a1[<span class="number">5</span>]</span><br><span class="line">       + <span class="number">20</span> * *a1</span><br><span class="line">       - <span class="number">81</span> * a1[<span class="number">1</span>]</span><br><span class="line">       - <span class="number">17</span> * a1[<span class="number">2</span>]</span><br><span class="line">       - <span class="number">77</span> * a1[<span class="number">3</span>]</span><br><span class="line">       - <span class="number">79</span> * a1[<span class="number">4</span>]</span><br><span class="line">       - <span class="number">45</span> * a1[<span class="number">6</span>]</span><br><span class="line">       - <span class="number">61</span> * a1[<span class="number">7</span>]</span><br><span class="line">       - <span class="number">48</span> * a1[<span class="number">8</span>]</span><br><span class="line">       - <span class="number">97</span> * a1[<span class="number">9</span>]</span><br><span class="line">       - <span class="number">49</span> * a1[<span class="number">11</span>]</span><br><span class="line">       - <span class="number">14</span> * a1[<span class="number">12</span>]</span><br><span class="line">       - <span class="number">81</span> * a1[<span class="number">14</span>]</span><br><span class="line">       - <span class="number">20</span> * a1[<span class="number">15</span>]</span><br><span class="line">       - <span class="number">27</span> * a1[<span class="number">16</span>]</span><br><span class="line">       - <span class="number">89</span> * a1[<span class="number">18</span>]</span><br><span class="line">       - <span class="number">93</span> * a1[<span class="number">19</span>]</span><br><span class="line">       - <span class="number">46</span> * a1[<span class="number">22</span>] == -<span class="number">55479</span></span><br><span class="line">      &amp;&amp; <span class="number">60</span> * a1[<span class="number">21</span>]</span><br><span class="line">       + <span class="number">70</span> * a1[<span class="number">20</span>]</span><br><span class="line">       + <span class="number">13</span> * a1[<span class="number">15</span>]</span><br><span class="line">       + <span class="number">87</span> * a1[<span class="number">13</span>]</span><br><span class="line">       + <span class="number">76</span> * a1[<span class="number">11</span>]</span><br><span class="line">       + <span class="number">88</span> * a1[<span class="number">9</span>]</span><br><span class="line">       + <span class="number">87</span> * a1[<span class="number">3</span>]</span><br><span class="line">       + <span class="number">87</span> * *a1</span><br><span class="line">       - <span class="number">97</span> * a1[<span class="number">1</span>]</span><br><span class="line">       - <span class="number">40</span> * a1[<span class="number">2</span>]</span><br><span class="line">       - <span class="number">49</span> * a1[<span class="number">4</span>]</span><br><span class="line">       - <span class="number">23</span> * a1[<span class="number">5</span>]</span><br><span class="line">       - <span class="number">30</span> * a1[<span class="number">6</span>]</span><br><span class="line">       - <span class="number">50</span> * a1[<span class="number">7</span>]</span><br><span class="line">       - <span class="number">98</span> * a1[<span class="number">8</span>]</span><br><span class="line">       - <span class="number">21</span> * a1[<span class="number">10</span>]</span><br><span class="line">       - <span class="number">54</span> * a1[<span class="number">12</span>]</span><br><span class="line">       - <span class="number">65</span> * a1[<span class="number">14</span>]</span><br><span class="line">       - <span class="number">80</span> * a1[<span class="number">17</span>]</span><br><span class="line">       - <span class="number">28</span> * a1[<span class="number">18</span>]</span><br><span class="line">       - <span class="number">57</span> * a1[<span class="number">19</span>]</span><br><span class="line">       - <span class="number">70</span> * a1[<span class="number">22</span>] == -<span class="number">20651</span></span><br><span class="line">      &amp;&amp; <span class="number">54</span> * a1[<span class="number">20</span>]</span><br><span class="line">       + <span class="number">86</span> * a1[<span class="number">17</span>]</span><br><span class="line">       + <span class="number">92</span> * a1[<span class="number">16</span>]</span><br><span class="line">       + <span class="number">41</span> * a1[<span class="number">15</span>]</span><br><span class="line">       + <span class="number">70</span> * a1[<span class="number">10</span>]</span><br><span class="line">       + <span class="number">9</span> * a1[<span class="number">9</span>]</span><br><span class="line">       + a1[<span class="number">8</span>]</span><br><span class="line">       + <span class="number">96</span> * a1[<span class="number">7</span>]</span><br><span class="line">       + <span class="number">45</span> * a1[<span class="number">6</span>]</span><br><span class="line">       + <span class="number">78</span> * a1[<span class="number">5</span>]</span><br><span class="line">       + <span class="number">3</span> * a1[<span class="number">4</span>]</span><br><span class="line">       + <span class="number">90</span> * a1[<span class="number">3</span>]</span><br><span class="line">       + <span class="number">71</span> * a1[<span class="number">2</span>]</span><br><span class="line">       + <span class="number">96</span> * *a1</span><br><span class="line">       - <span class="number">8</span> * a1[<span class="number">1</span>]</span><br><span class="line">       + <span class="number">4</span> * a1[<span class="number">11</span>]</span><br><span class="line">       - <span class="number">55</span> * a1[<span class="number">12</span>]</span><br><span class="line">       - <span class="number">73</span> * a1[<span class="number">13</span>]</span><br><span class="line">       - <span class="number">54</span> * a1[<span class="number">14</span>]</span><br><span class="line">       - <span class="number">89</span> * a1[<span class="number">18</span>]</span><br><span class="line">       - (a1[<span class="number">19</span>] &lt;&lt; <span class="number">6</span>)</span><br><span class="line">       - <span class="number">67</span> * a1[<span class="number">21</span>]</span><br><span class="line">       + <span class="number">4</span> * a1[<span class="number">22</span>] == <span class="number">35926</span></span><br><span class="line">      &amp;&amp; <span class="number">5</span> * a1[<span class="number">22</span>]</span><br><span class="line">       + <span class="number">88</span> * a1[<span class="number">20</span>]</span><br><span class="line">       + <span class="number">52</span> * a1[<span class="number">19</span>]</span><br><span class="line">       + <span class="number">21</span> * a1[<span class="number">17</span>]</span><br><span class="line">       + <span class="number">25</span> * a1[<span class="number">16</span>]</span><br><span class="line">       + <span class="number">3</span> * a1[<span class="number">13</span>]</span><br><span class="line">       + <span class="number">88</span> * a1[<span class="number">10</span>]</span><br><span class="line">       + <span class="number">39</span> * a1[<span class="number">8</span>]</span><br><span class="line">       + <span class="number">48</span> * a1[<span class="number">7</span>]</span><br><span class="line">       + <span class="number">74</span> * a1[<span class="number">6</span>]</span><br><span class="line">       + <span class="number">86</span> * a1[<span class="number">4</span>]</span><br><span class="line">       + <span class="number">46</span> * a1[<span class="number">2</span>]</span><br><span class="line">       + <span class="number">17</span> * *a1</span><br><span class="line">       - <span class="number">98</span> * a1[<span class="number">1</span>]</span><br><span class="line">       - <span class="number">50</span> * a1[<span class="number">3</span>]</span><br><span class="line">       - <span class="number">28</span> * a1[<span class="number">5</span>]</span><br><span class="line">       - <span class="number">73</span> * a1[<span class="number">9</span>]</span><br><span class="line">       - <span class="number">33</span> * a1[<span class="number">11</span>]</span><br><span class="line">       - <span class="number">75</span> * a1[<span class="number">12</span>]</span><br><span class="line">       - <span class="number">14</span> * a1[<span class="number">14</span>]</span><br><span class="line">       - <span class="number">31</span> * a1[<span class="number">15</span>]</span><br><span class="line">       - <span class="number">26</span> * a1[<span class="number">18</span>]</span><br><span class="line">       - <span class="number">52</span> * a1[<span class="number">21</span>] == <span class="number">8283</span></span><br><span class="line">      &amp;&amp; <span class="number">96</span> * a1[<span class="number">22</span>]</span><br><span class="line">       + <span class="number">85</span> * a1[<span class="number">20</span>]</span><br><span class="line">       + <span class="number">55</span> * a1[<span class="number">19</span>]</span><br><span class="line">       + <span class="number">99</span> * a1[<span class="number">13</span>]</span><br><span class="line">       + <span class="number">19</span> * a1[<span class="number">11</span>]</span><br><span class="line">       + <span class="number">77</span> * a1[<span class="number">10</span>]</span><br><span class="line">       + <span class="number">52</span> * a1[<span class="number">9</span>]</span><br><span class="line">       + <span class="number">66</span> * a1[<span class="number">8</span>]</span><br><span class="line">       + <span class="number">96</span> * a1[<span class="number">6</span>]</span><br><span class="line">       + <span class="number">72</span> * a1[<span class="number">4</span>]</span><br><span class="line">       + <span class="number">90</span> * a1[<span class="number">3</span>]</span><br><span class="line">       + <span class="number">60</span> * a1[<span class="number">1</span>]</span><br><span class="line">       + <span class="number">94</span> * *a1</span><br><span class="line">       - <span class="number">99</span> * a1[<span class="number">2</span>]</span><br><span class="line">       - <span class="number">26</span> * a1[<span class="number">5</span>]</span><br><span class="line">       - <span class="number">94</span> * a1[<span class="number">7</span>]</span><br><span class="line">       - <span class="number">49</span> * a1[<span class="number">12</span>]</span><br><span class="line">       - <span class="number">32</span> * a1[<span class="number">14</span>]</span><br><span class="line">       - <span class="number">54</span> * a1[<span class="number">15</span>]</span><br><span class="line">       - <span class="number">92</span> * a1[<span class="number">16</span>]</span><br><span class="line">       - <span class="number">71</span> * a1[<span class="number">17</span>]</span><br><span class="line">       - <span class="number">63</span> * a1[<span class="number">18</span>]</span><br><span class="line">       - <span class="number">23</span> * a1[<span class="number">21</span>] == <span class="number">33789</span></span><br><span class="line">      &amp;&amp; <span class="number">15</span> * a1[<span class="number">22</span>]</span><br><span class="line">       + a1[<span class="number">19</span>]</span><br><span class="line">       + <span class="number">26</span> * a1[<span class="number">17</span>]</span><br><span class="line">       + <span class="number">65</span> * a1[<span class="number">16</span>]</span><br><span class="line">       + <span class="number">80</span> * a1[<span class="number">11</span>]</span><br><span class="line">       + <span class="number">92</span> * a1[<span class="number">8</span>]</span><br><span class="line">       + <span class="number">28</span> * a1[<span class="number">5</span>]</span><br><span class="line">       + <span class="number">79</span> * a1[<span class="number">4</span>]</span><br><span class="line">       + <span class="number">73</span> * *a1</span><br><span class="line">       - <span class="number">98</span> * a1[<span class="number">1</span>]</span><br><span class="line">       - <span class="number">2</span> * a1[<span class="number">2</span>]</span><br><span class="line">       - <span class="number">70</span> * a1[<span class="number">3</span>]</span><br><span class="line">       - <span class="number">10</span> * a1[<span class="number">6</span>]</span><br><span class="line">       - <span class="number">30</span> * a1[<span class="number">7</span>]</span><br><span class="line">       - <span class="number">51</span> * a1[<span class="number">9</span>]</span><br><span class="line">       - <span class="number">77</span> * a1[<span class="number">10</span>]</span><br><span class="line">       - <span class="number">32</span> * a1[<span class="number">12</span>]</span><br><span class="line">       - <span class="number">32</span> * a1[<span class="number">13</span>]</span><br><span class="line">       + <span class="number">8</span> * a1[<span class="number">14</span>]</span><br><span class="line">       + <span class="number">4</span> * a1[<span class="number">15</span>]</span><br><span class="line">       - <span class="number">11</span> * a1[<span class="number">18</span>]</span><br><span class="line">       - <span class="number">83</span> * a1[<span class="number">20</span>]</span><br><span class="line">       - <span class="number">85</span> * a1[<span class="number">21</span>] == -<span class="number">10455</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>可以看到，这一大长串包含了<strong>22个等式</strong>，对<code>a1[0]</code>到<code>a1[22]</code>共23个变量进行了约束，</p>
<p>值得注意的是：</p>
<ul>
<li><code>*a1</code>其实就是<code>a1[0]</code>，第一个变量</li>
<li><code>a1[i] &lt;&lt; 6 = 64 * a1[i]</code> (左移6位实际上就是<code>*64</code>)</li>
</ul>
<p>根据<code>_main</code>函数的汇编代码，得到是<code>z3</code>算法，</p>
<p>编写最终的EXP：</p>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">x = [Int(<span class="string">f&#x27;x<span class="subst">&#123;i&#125;</span>&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">23</span>)]</span><br><span class="line">s = Solver()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">23</span>):</span><br><span class="line">    s.add(x[i] &gt;= <span class="number">32</span>, x[i] &lt;= <span class="number">126</span>)</span><br><span class="line"></span><br><span class="line">s.add(</span><br><span class="line">    <span class="number">94</span>*x[<span class="number">22</span>] + <span class="number">74</span>*x[<span class="number">21</span>] + <span class="number">70</span>*x[<span class="number">19</span>] + <span class="number">12</span>*x[<span class="number">18</span>] + <span class="number">20</span>*x[<span class="number">16</span>] + <span class="number">62</span>*x[<span class="number">12</span>] + <span class="number">82</span>*x[<span class="number">10</span>] +</span><br><span class="line">    <span class="number">7</span>*x[<span class="number">7</span>] + <span class="number">63</span>*x[<span class="number">6</span>] + <span class="number">18</span>*x[<span class="number">5</span>] + <span class="number">58</span>*x[<span class="number">4</span>] + <span class="number">94</span>*x[<span class="number">2</span>] + <span class="number">77</span>*x[<span class="number">0</span>] -</span><br><span class="line">    <span class="number">43</span>*x[<span class="number">1</span>] - <span class="number">37</span>*x[<span class="number">3</span>] - <span class="number">97</span>*x[<span class="number">8</span>] - <span class="number">23</span>*x[<span class="number">9</span>] - <span class="number">86</span>*x[<span class="number">11</span>] - <span class="number">6</span>*x[<span class="number">13</span>] - <span class="number">5</span>*x[<span class="number">14</span>] -</span><br><span class="line">    <span class="number">79</span>*x[<span class="number">15</span>] - <span class="number">63</span>*x[<span class="number">17</span>] - <span class="number">93</span>*x[<span class="number">20</span>] == <span class="number">20156</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">s.add(</span><br><span class="line">    <span class="number">87</span>*x[<span class="number">22</span>] + <span class="number">75</span>*x[<span class="number">21</span>] + <span class="number">73</span>*x[<span class="number">15</span>] + <span class="number">67</span>*x[<span class="number">14</span>] + <span class="number">30</span>*x[<span class="number">13</span>] + <span class="number">64</span>*x[<span class="number">11</span>] + <span class="number">35</span>*x[<span class="number">9</span>] +</span><br><span class="line">    <span class="number">91</span>*x[<span class="number">7</span>] + <span class="number">91</span>*x[<span class="number">5</span>] + <span class="number">34</span>*x[<span class="number">3</span>] + <span class="number">74</span>*x[<span class="number">0</span>] -</span><br><span class="line">    <span class="number">89</span>*x[<span class="number">1</span>] - <span class="number">72</span>*x[<span class="number">2</span>] - <span class="number">76</span>*x[<span class="number">4</span>] - <span class="number">32</span>*x[<span class="number">6</span>] - <span class="number">97</span>*x[<span class="number">8</span>] - <span class="number">39</span>*x[<span class="number">10</span>] - <span class="number">23</span>*x[<span class="number">12</span>] +</span><br><span class="line">    <span class="number">8</span>*x[<span class="number">16</span>] - <span class="number">98</span>*x[<span class="number">17</span>] - <span class="number">4</span>*x[<span class="number">18</span>] - <span class="number">80</span>*x[<span class="number">19</span>] - <span class="number">83</span>*x[<span class="number">20</span>] == <span class="number">7183</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">s.add(</span><br><span class="line">    <span class="number">51</span>*x[<span class="number">21</span>] + <span class="number">22</span>*x[<span class="number">20</span>] + <span class="number">15</span>*x[<span class="number">19</span>] + <span class="number">51</span>*x[<span class="number">17</span>] + <span class="number">96</span>*x[<span class="number">12</span>] + <span class="number">34</span>*x[<span class="number">7</span>] + <span class="number">77</span>*x[<span class="number">5</span>] +</span><br><span class="line">    <span class="number">59</span>*x[<span class="number">2</span>] + <span class="number">89</span>*x[<span class="number">1</span>] + <span class="number">92</span>*x[<span class="number">0</span>] -</span><br><span class="line">    <span class="number">85</span>*x[<span class="number">3</span>] - <span class="number">50</span>*x[<span class="number">4</span>] - <span class="number">51</span>*x[<span class="number">6</span>] - <span class="number">75</span>*x[<span class="number">8</span>] - <span class="number">40</span>*x[<span class="number">10</span>] - <span class="number">4</span>*x[<span class="number">11</span>] - <span class="number">74</span>*x[<span class="number">13</span>] -</span><br><span class="line">    <span class="number">98</span>*x[<span class="number">14</span>] - <span class="number">23</span>*x[<span class="number">15</span>] - <span class="number">14</span>*x[<span class="number">16</span>] - <span class="number">92</span>*x[<span class="number">18</span>] - <span class="number">7</span>*x[<span class="number">22</span>] == -<span class="number">7388</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">s.add(</span><br><span class="line">    <span class="number">61</span>*x[<span class="number">22</span>] + <span class="number">72</span>*x[<span class="number">21</span>] + <span class="number">28</span>*x[<span class="number">20</span>] + <span class="number">55</span>*x[<span class="number">18</span>] + <span class="number">20</span>*x[<span class="number">17</span>] + <span class="number">13</span>*x[<span class="number">14</span>] + <span class="number">51</span>*x[<span class="number">13</span>] +</span><br><span class="line">    <span class="number">69</span>*x[<span class="number">12</span>] + <span class="number">10</span>*x[<span class="number">11</span>] + <span class="number">95</span>*x[<span class="number">10</span>] + <span class="number">43</span>*x[<span class="number">9</span>] + <span class="number">53</span>*x[<span class="number">8</span>] + <span class="number">76</span>*x[<span class="number">7</span>] + <span class="number">25</span>*x[<span class="number">6</span>] +</span><br><span class="line">    <span class="number">9</span>*x[<span class="number">5</span>] + <span class="number">10</span>*x[<span class="number">4</span>] + <span class="number">98</span>*x[<span class="number">1</span>] + <span class="number">70</span>*x[<span class="number">0</span>] -</span><br><span class="line">    <span class="number">22</span>*x[<span class="number">2</span>] + <span class="number">2</span>*x[<span class="number">3</span>] - <span class="number">49</span>*x[<span class="number">15</span>] + <span class="number">4</span>*x[<span class="number">16</span>] - <span class="number">77</span>*x[<span class="number">19</span>] == <span class="number">69057</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">s.add(</span><br><span class="line">    <span class="number">7</span>*x[<span class="number">22</span>] + <span class="number">21</span>*x[<span class="number">16</span>] + <span class="number">22</span>*x[<span class="number">13</span>] + <span class="number">55</span>*x[<span class="number">9</span>] + <span class="number">66</span>*x[<span class="number">8</span>] + <span class="number">78</span>*x[<span class="number">5</span>] + <span class="number">10</span>*x[<span class="number">3</span>] +</span><br><span class="line">    <span class="number">80</span>*x[<span class="number">1</span>] + <span class="number">65</span>*x[<span class="number">0</span>] -</span><br><span class="line">    <span class="number">20</span>*x[<span class="number">2</span>] - <span class="number">53</span>*x[<span class="number">4</span>] - <span class="number">98</span>*x[<span class="number">6</span>] + <span class="number">8</span>*x[<span class="number">7</span>] - <span class="number">78</span>*x[<span class="number">10</span>] - <span class="number">94</span>*x[<span class="number">11</span>] - <span class="number">93</span>*x[<span class="number">12</span>] -</span><br><span class="line">    <span class="number">18</span>*x[<span class="number">14</span>] - <span class="number">48</span>*x[<span class="number">15</span>] - <span class="number">9</span>*x[<span class="number">17</span>] - <span class="number">73</span>*x[<span class="number">18</span>] - <span class="number">59</span>*x[<span class="number">19</span>] - <span class="number">68</span>*x[<span class="number">20</span>] - <span class="number">74</span>*x[<span class="number">21</span>] == -<span class="number">31438</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">s.add(</span><br><span class="line">    <span class="number">33</span>*x[<span class="number">19</span>] + <span class="number">78</span>*x[<span class="number">15</span>] + <span class="number">66</span>*x[<span class="number">10</span>] + <span class="number">3</span>*x[<span class="number">9</span>] + <span class="number">43</span>*x[<span class="number">4</span>] + <span class="number">24</span>*x[<span class="number">3</span>] + <span class="number">3</span>*x[<span class="number">2</span>] +</span><br><span class="line">    <span class="number">27</span>*x[<span class="number">0</span>] -</span><br><span class="line">    <span class="number">18</span>*x[<span class="number">1</span>] - <span class="number">46</span>*x[<span class="number">5</span>] - <span class="number">18</span>*x[<span class="number">6</span>] - x[<span class="number">7</span>] - <span class="number">33</span>*x[<span class="number">8</span>] - <span class="number">50</span>*x[<span class="number">11</span>] - <span class="number">23</span>*x[<span class="number">12</span>] -</span><br><span class="line">    <span class="number">37</span>*x[<span class="number">13</span>] - <span class="number">45</span>*x[<span class="number">14</span>] + <span class="number">2</span>*x[<span class="number">16</span>] - x[<span class="number">17</span>] - <span class="number">60</span>*x[<span class="number">18</span>] - <span class="number">87</span>*x[<span class="number">20</span>] - <span class="number">72</span>*x[<span class="number">21</span>] - <span class="number">6</span>*x[<span class="number">22</span>] == -<span class="number">26121</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">s.add(</span><br><span class="line">    <span class="number">31</span>*x[<span class="number">20</span>] + <span class="number">80</span>*x[<span class="number">18</span>] + <span class="number">34</span>*x[<span class="number">17</span>] + <span class="number">34</span>*x[<span class="number">15</span>] + <span class="number">38</span>*x[<span class="number">14</span>] + <span class="number">53</span>*x[<span class="number">13</span>] + <span class="number">35</span>*x[<span class="number">12</span>] +</span><br><span class="line">    <span class="number">82</span>*x[<span class="number">9</span>] + <span class="number">27</span>*x[<span class="number">8</span>] + <span class="number">80</span>*x[<span class="number">7</span>] + <span class="number">46</span>*x[<span class="number">6</span>] + <span class="number">18</span>*x[<span class="number">4</span>] + <span class="number">5</span>*x[<span class="number">1</span>] + <span class="number">98</span>*x[<span class="number">0</span>] -</span><br><span class="line">    <span class="number">12</span>*x[<span class="number">2</span>] - <span class="number">9</span>*x[<span class="number">3</span>] - <span class="number">57</span>*x[<span class="number">5</span>] - <span class="number">46</span>*x[<span class="number">10</span>] - <span class="number">31</span>*x[<span class="number">11</span>] - <span class="number">68</span>*x[<span class="number">16</span>] - <span class="number">94</span>*x[<span class="number">19</span>] -</span><br><span class="line">    <span class="number">93</span>*x[<span class="number">21</span>] - <span class="number">15</span>*x[<span class="number">22</span>] == <span class="number">26005</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">s.add(</span><br><span class="line">    <span class="number">81</span>*x[<span class="number">21</span>] + <span class="number">40</span>*x[<span class="number">20</span>] + <span class="number">34</span>*x[<span class="number">19</span>] + <span class="number">94</span>*x[<span class="number">18</span>] + <span class="number">98</span>*x[<span class="number">17</span>] + <span class="number">11</span>*x[<span class="number">14</span>] + <span class="number">63</span>*x[<span class="number">13</span>] +</span><br><span class="line">    <span class="number">95</span>*x[<span class="number">12</span>] + <span class="number">43</span>*x[<span class="number">11</span>] + <span class="number">99</span>*x[<span class="number">10</span>] + <span class="number">29</span>*x[<span class="number">9</span>] + <span class="number">81</span>*x[<span class="number">6</span>] + <span class="number">72</span>*x[<span class="number">5</span>] + <span class="number">54</span>*x[<span class="number">3</span>] +</span><br><span class="line">    <span class="number">21</span>*x[<span class="number">0</span>] -</span><br><span class="line">    <span class="number">26</span>*x[<span class="number">1</span>] - <span class="number">90</span>*x[<span class="number">2</span>] - <span class="number">15</span>*x[<span class="number">4</span>] - <span class="number">54</span>*x[<span class="number">7</span>] - <span class="number">12</span>*x[<span class="number">8</span>] - <span class="number">38</span>*x[<span class="number">15</span>] - <span class="number">15</span>*x[<span class="number">16</span>] - <span class="number">56</span>*x[<span class="number">22</span>] == <span class="number">57169</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">s.add(</span><br><span class="line">    <span class="number">71</span>*x[<span class="number">18</span>] + <span class="number">39</span>*x[<span class="number">17</span>] + <span class="number">73</span>*x[<span class="number">15</span>] + <span class="number">14</span>*x[<span class="number">14</span>] + <span class="number">56</span>*x[<span class="number">12</span>] + <span class="number">56</span>*x[<span class="number">10</span>] + <span class="number">27</span>*x[<span class="number">9</span>] +</span><br><span class="line">    <span class="number">68</span>*x[<span class="number">7</span>] + <span class="number">39</span>*x[<span class="number">6</span>] + <span class="number">26</span>*x[<span class="number">5</span>] + <span class="number">40</span>*x[<span class="number">4</span>] + <span class="number">24</span>*x[<span class="number">3</span>] + <span class="number">11</span>*x[<span class="number">2</span>] + <span class="number">14</span>*x[<span class="number">1</span>] + <span class="number">94</span>*x[<span class="number">0</span>] -</span><br><span class="line">    <span class="number">10</span>*x[<span class="number">8</span>] - <span class="number">11</span>*x[<span class="number">11</span>] - <span class="number">63</span>*x[<span class="number">13</span>] - <span class="number">39</span>*x[<span class="number">16</span>] - <span class="number">14</span>*x[<span class="number">19</span>] - <span class="number">17</span>*x[<span class="number">20</span>] - <span class="number">23</span>*x[<span class="number">21</span>] - <span class="number">7</span>*x[<span class="number">22</span>] == <span class="number">40024</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">s.add(</span><br><span class="line">    <span class="number">64</span>*x[<span class="number">22</span>] + <span class="number">80</span>*x[<span class="number">21</span>] + <span class="number">89</span>*x[<span class="number">20</span>] + <span class="number">70</span>*x[<span class="number">19</span>] + <span class="number">66</span>*x[<span class="number">18</span>] + <span class="number">55</span>*x[<span class="number">17</span>] + <span class="number">16</span>*x[<span class="number">16</span>] +</span><br><span class="line">    <span class="number">84</span>*x[<span class="number">13</span>] + <span class="number">48</span>*x[<span class="number">12</span>] + <span class="number">11</span>*x[<span class="number">7</span>] + <span class="number">32</span>*x[<span class="number">5</span>] + <span class="number">99</span>*x[<span class="number">0</span>] -</span><br><span class="line">    <span class="number">26</span>*x[<span class="number">1</span>] - <span class="number">91</span>*x[<span class="number">2</span>] - <span class="number">96</span>*x[<span class="number">3</span>] - <span class="number">63</span>*x[<span class="number">4</span>] - <span class="number">67</span>*x[<span class="number">6</span>] - <span class="number">72</span>*x[<span class="number">8</span>] + <span class="number">4</span>*x[<span class="number">9</span>] -</span><br><span class="line">    <span class="number">84</span>*x[<span class="number">10</span>] - <span class="number">81</span>*x[<span class="number">11</span>] - <span class="number">80</span>*x[<span class="number">14</span>] - <span class="number">98</span>*x[<span class="number">15</span>] == <span class="number">432</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">s.add(</span><br><span class="line">    x[<span class="number">21</span>] + <span class="number">41</span>*x[<span class="number">17</span>] + <span class="number">46</span>*x[<span class="number">12</span>] + <span class="number">44</span>*x[<span class="number">9</span>] + <span class="number">63</span>*x[<span class="number">0</span>] -</span><br><span class="line">    <span class="number">73</span>*x[<span class="number">1</span>] - <span class="number">43</span>*x[<span class="number">2</span>] + <span class="number">4</span>*x[<span class="number">3</span>] - <span class="number">37</span>*x[<span class="number">4</span>] - <span class="number">54</span>*x[<span class="number">5</span>] - <span class="number">58</span>*x[<span class="number">6</span>] - <span class="number">95</span>*x[<span class="number">7</span>] -</span><br><span class="line">    <span class="number">2</span>*x[<span class="number">8</span>] - <span class="number">37</span>*x[<span class="number">10</span>] - <span class="number">5</span>*x[<span class="number">11</span>] + <span class="number">2</span>*x[<span class="number">13</span>] - <span class="number">46</span>*x[<span class="number">14</span>] - <span class="number">27</span>*x[<span class="number">15</span>] - <span class="number">19</span>*x[<span class="number">16</span>] -</span><br><span class="line">    <span class="number">78</span>*x[<span class="number">18</span>] - <span class="number">51</span>*x[<span class="number">19</span>] - <span class="number">82</span>*x[<span class="number">20</span>] - <span class="number">59</span>*x[<span class="number">22</span>] == -<span class="number">57338</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">s.add(</span><br><span class="line">    <span class="number">10</span>*x[<span class="number">22</span>] + <span class="number">58</span>*x[<span class="number">18</span>] + <span class="number">16</span>*x[<span class="number">17</span>] + <span class="number">69</span>*x[<span class="number">16</span>] + <span class="number">6</span>*x[<span class="number">15</span>] + <span class="number">5</span>*x[<span class="number">12</span>] + <span class="number">87</span>*x[<span class="number">7</span>] +</span><br><span class="line">    <span class="number">47</span>*x[<span class="number">5</span>] + <span class="number">91</span>*x[<span class="number">4</span>] + <span class="number">54</span>*x[<span class="number">2</span>] + <span class="number">21</span>*x[<span class="number">1</span>] + <span class="number">52</span>*x[<span class="number">0</span>] -</span><br><span class="line">    <span class="number">76</span>*x[<span class="number">3</span>] - <span class="number">96</span>*x[<span class="number">6</span>] - <span class="number">27</span>*x[<span class="number">8</span>] - <span class="number">43</span>*x[<span class="number">9</span>] - <span class="number">15</span>*x[<span class="number">10</span>] - <span class="number">35</span>*x[<span class="number">11</span>] - <span class="number">53</span>*x[<span class="number">13</span>] +</span><br><span class="line">    <span class="number">4</span>*x[<span class="number">14</span>] - <span class="number">83</span>*x[<span class="number">19</span>] - <span class="number">68</span>*x[<span class="number">20</span>] - <span class="number">18</span>*x[<span class="number">21</span>] == <span class="number">1777</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">s.add(</span><br><span class="line">    <span class="number">66</span>*x[<span class="number">22</span>] + <span class="number">92</span>*x[<span class="number">21</span>] + <span class="number">29</span>*x[<span class="number">20</span>] + <span class="number">42</span>*x[<span class="number">19</span>] + <span class="number">55</span>*x[<span class="number">14</span>] + <span class="number">72</span>*x[<span class="number">13</span>] + <span class="number">40</span>*x[<span class="number">12</span>] +</span><br><span class="line">    <span class="number">31</span>*x[<span class="number">10</span>] + <span class="number">88</span>*x[<span class="number">9</span>] + <span class="number">61</span>*x[<span class="number">8</span>] + <span class="number">59</span>*x[<span class="number">7</span>] + <span class="number">35</span>*x[<span class="number">6</span>] + <span class="number">16</span>*x[<span class="number">3</span>] + <span class="number">24</span>*x[<span class="number">1</span>] + <span class="number">60</span>*x[<span class="number">0</span>] -</span><br><span class="line">    <span class="number">55</span>*x[<span class="number">2</span>] - <span class="number">8</span>*x[<span class="number">4</span>] - <span class="number">7</span>*x[<span class="number">5</span>] - <span class="number">17</span>*x[<span class="number">11</span>] - <span class="number">25</span>*x[<span class="number">15</span>] - <span class="number">22</span>*x[<span class="number">16</span>] - <span class="number">10</span>*x[<span class="number">17</span>] - <span class="number">59</span>*x[<span class="number">18</span>] == <span class="number">47727</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">s.add(</span><br><span class="line">    <span class="number">3</span>*x[<span class="number">21</span>] + <span class="number">54</span>*x[<span class="number">18</span>] + <span class="number">6</span>*x[<span class="number">15</span>] + <span class="number">93</span>*x[<span class="number">14</span>] + <span class="number">74</span>*x[<span class="number">10</span>] + <span class="number">6</span>*x[<span class="number">7</span>] + <span class="number">98</span>*x[<span class="number">4</span>] + <span class="number">65</span>*x[<span class="number">3</span>] +</span><br><span class="line">    <span class="number">84</span>*x[<span class="number">2</span>] + <span class="number">18</span>*x[<span class="number">1</span>] + <span class="number">35</span>*x[<span class="number">0</span>] -</span><br><span class="line">    <span class="number">29</span>*x[<span class="number">5</span>] - <span class="number">40</span>*x[<span class="number">6</span>] - <span class="number">35</span>*x[<span class="number">8</span>] + <span class="number">8</span>*x[<span class="number">9</span>] - <span class="number">15</span>*x[<span class="number">11</span>] - <span class="number">4</span>*x[<span class="number">12</span>] - <span class="number">83</span>*x[<span class="number">16</span>] -</span><br><span class="line">    <span class="number">74</span>*x[<span class="number">17</span>] - <span class="number">72</span>*x[<span class="number">19</span>] - <span class="number">53</span>*x[<span class="number">20</span>] - <span class="number">31</span>*x[<span class="number">22</span>] == <span class="number">6695</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">s.add(</span><br><span class="line">    <span class="number">45</span>*x[<span class="number">20</span>] + <span class="number">14</span>*x[<span class="number">19</span>] + <span class="number">76</span>*x[<span class="number">18</span>] + <span class="number">17</span>*x[<span class="number">16</span>] + <span class="number">86</span>*x[<span class="number">14</span>] + <span class="number">28</span>*x[<span class="number">11</span>] + <span class="number">19</span>*x[<span class="number">5</span>] +</span><br><span class="line">    <span class="number">46</span>*x[<span class="number">1</span>] + <span class="number">75</span>*x[<span class="number">0</span>] -</span><br><span class="line">    <span class="number">12</span>*x[<span class="number">2</span>] - <span class="number">27</span>*x[<span class="number">3</span>] - <span class="number">66</span>*x[<span class="number">4</span>] - <span class="number">27</span>*x[<span class="number">6</span>] - <span class="number">32</span>*x[<span class="number">7</span>] - <span class="number">69</span>*x[<span class="number">8</span>] - <span class="number">31</span>*x[<span class="number">9</span>] -</span><br><span class="line">    <span class="number">65</span>*x[<span class="number">10</span>] - <span class="number">54</span>*x[<span class="number">12</span>] - <span class="number">6</span>*x[<span class="number">13</span>] + <span class="number">2</span>*x[<span class="number">15</span>] - <span class="number">10</span>*x[<span class="number">17</span>] - <span class="number">89</span>*x[<span class="number">21</span>] - <span class="number">16</span>*x[<span class="number">22</span>] == -<span class="number">3780</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">s.add(</span><br><span class="line">    <span class="number">62</span>*x[<span class="number">21</span>] + <span class="number">74</span>*x[<span class="number">20</span>] + <span class="number">28</span>*x[<span class="number">18</span>] + <span class="number">7</span>*x[<span class="number">17</span>] + <span class="number">74</span>*x[<span class="number">16</span>] + <span class="number">45</span>*x[<span class="number">15</span>] + <span class="number">57</span>*x[<span class="number">14</span>] +</span><br><span class="line">    <span class="number">34</span>*x[<span class="number">11</span>] + <span class="number">85</span>*x[<span class="number">10</span>] + <span class="number">98</span>*x[<span class="number">6</span>] + <span class="number">29</span>*x[<span class="number">4</span>] + <span class="number">94</span>*x[<span class="number">3</span>] + <span class="number">51</span>*x[<span class="number">2</span>] + <span class="number">85</span>*x[<span class="number">1</span>] -</span><br><span class="line">    <span class="number">36</span>*x[<span class="number">5</span>] - x[<span class="number">7</span>] - <span class="number">3</span>*x[<span class="number">8</span>] - <span class="number">74</span>*x[<span class="number">9</span>] - <span class="number">70</span>*x[<span class="number">12</span>] - <span class="number">68</span>*x[<span class="number">13</span>] - <span class="number">3</span>*x[<span class="number">19</span>] + <span class="number">8</span>*x[<span class="number">22</span>] == <span class="number">47300</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">s.add(</span><br><span class="line">    <span class="number">22</span>*x[<span class="number">22</span>] + <span class="number">45</span>*x[<span class="number">21</span>] + <span class="number">14</span>*x[<span class="number">19</span>] + <span class="number">32</span>*x[<span class="number">18</span>] + <span class="number">77</span>*x[<span class="number">17</span>] + <span class="number">70</span>*x[<span class="number">12</span>] + <span class="number">7</span>*x[<span class="number">10</span>] +</span><br><span class="line">    <span class="number">99</span>*x[<span class="number">4</span>] + <span class="number">82</span>*x[<span class="number">0</span>] -</span><br><span class="line">    <span class="number">48</span>*x[<span class="number">1</span>] - <span class="number">40</span>*x[<span class="number">2</span>] - <span class="number">81</span>*x[<span class="number">3</span>] - <span class="number">27</span>*x[<span class="number">5</span>] - <span class="number">75</span>*x[<span class="number">6</span>] - <span class="number">79</span>*x[<span class="number">7</span>] - <span class="number">26</span>*x[<span class="number">8</span>] -</span><br><span class="line">    <span class="number">68</span>*x[<span class="number">9</span>] - <span class="number">57</span>*x[<span class="number">11</span>] - <span class="number">77</span>*x[<span class="number">13</span>] - <span class="number">32</span>*x[<span class="number">14</span>] - x[<span class="number">15</span>] - <span class="number">91</span>*x[<span class="number">16</span>] - <span class="number">14</span>*x[<span class="number">20</span>] == -<span class="number">34153</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">s.add(</span><br><span class="line">    <span class="number">65</span>*x[<span class="number">21</span>] + <span class="number">13</span>*x[<span class="number">20</span>] + <span class="number">61</span>*x[<span class="number">17</span>] + <span class="number">97</span>*x[<span class="number">13</span>] + <span class="number">24</span>*x[<span class="number">10</span>] + <span class="number">40</span>*x[<span class="number">5</span>] + <span class="number">20</span>*x[<span class="number">0</span>] -</span><br><span class="line">    <span class="number">81</span>*x[<span class="number">1</span>] - <span class="number">17</span>*x[<span class="number">2</span>] - <span class="number">77</span>*x[<span class="number">3</span>] - <span class="number">79</span>*x[<span class="number">4</span>] - <span class="number">45</span>*x[<span class="number">6</span>] - <span class="number">61</span>*x[<span class="number">7</span>] - <span class="number">48</span>*x[<span class="number">8</span>] -</span><br><span class="line">    <span class="number">97</span>*x[<span class="number">9</span>] - <span class="number">49</span>*x[<span class="number">11</span>] - <span class="number">14</span>*x[<span class="number">12</span>] - <span class="number">81</span>*x[<span class="number">14</span>] - <span class="number">20</span>*x[<span class="number">15</span>] - <span class="number">27</span>*x[<span class="number">16</span>] - <span class="number">89</span>*x[<span class="number">18</span>] -</span><br><span class="line">    <span class="number">93</span>*x[<span class="number">19</span>] - <span class="number">46</span>*x[<span class="number">22</span>] == -<span class="number">55479</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">s.add(</span><br><span class="line">    <span class="number">60</span>*x[<span class="number">21</span>] + <span class="number">70</span>*x[<span class="number">20</span>] + <span class="number">13</span>*x[<span class="number">15</span>] + <span class="number">87</span>*x[<span class="number">13</span>] + <span class="number">76</span>*x[<span class="number">11</span>] + <span class="number">88</span>*x[<span class="number">9</span>] + <span class="number">87</span>*x[<span class="number">3</span>] + <span class="number">87</span>*x[<span class="number">0</span>] -</span><br><span class="line">    <span class="number">97</span>*x[<span class="number">1</span>] - <span class="number">40</span>*x[<span class="number">2</span>] - <span class="number">49</span>*x[<span class="number">4</span>] - <span class="number">23</span>*x[<span class="number">5</span>] - <span class="number">30</span>*x[<span class="number">6</span>] - <span class="number">50</span>*x[<span class="number">7</span>] - <span class="number">98</span>*x[<span class="number">8</span>] -</span><br><span class="line">    <span class="number">21</span>*x[<span class="number">10</span>] - <span class="number">54</span>*x[<span class="number">12</span>] - <span class="number">65</span>*x[<span class="number">14</span>] - <span class="number">80</span>*x[<span class="number">17</span>] - <span class="number">28</span>*x[<span class="number">18</span>] - <span class="number">57</span>*x[<span class="number">19</span>] - <span class="number">70</span>*x[<span class="number">22</span>] == -<span class="number">20651</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">s.add(</span><br><span class="line">    <span class="number">54</span>*x[<span class="number">20</span>] + <span class="number">86</span>*x[<span class="number">17</span>] + <span class="number">92</span>*x[<span class="number">16</span>] + <span class="number">41</span>*x[<span class="number">15</span>] + <span class="number">70</span>*x[<span class="number">10</span>] + <span class="number">9</span>*x[<span class="number">9</span>] + x[<span class="number">8</span>] +</span><br><span class="line">    <span class="number">96</span>*x[<span class="number">7</span>] + <span class="number">45</span>*x[<span class="number">6</span>] + <span class="number">78</span>*x[<span class="number">5</span>] + <span class="number">3</span>*x[<span class="number">4</span>] + <span class="number">90</span>*x[<span class="number">3</span>] + <span class="number">71</span>*x[<span class="number">2</span>] + <span class="number">96</span>*x[<span class="number">0</span>] -</span><br><span class="line">    <span class="number">8</span>*x[<span class="number">1</span>] + <span class="number">4</span>*x[<span class="number">11</span>] - <span class="number">55</span>*x[<span class="number">12</span>] - <span class="number">73</span>*x[<span class="number">13</span>] - <span class="number">54</span>*x[<span class="number">14</span>] - <span class="number">89</span>*x[<span class="number">18</span>] - <span class="number">64</span>*x[<span class="number">19</span>] -</span><br><span class="line">    <span class="number">67</span>*x[<span class="number">21</span>] + <span class="number">4</span>*x[<span class="number">22</span>] == <span class="number">35926</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">s.add(</span><br><span class="line">    <span class="number">5</span>*x[<span class="number">22</span>] + <span class="number">88</span>*x[<span class="number">20</span>] + <span class="number">52</span>*x[<span class="number">19</span>] + <span class="number">21</span>*x[<span class="number">17</span>] + <span class="number">25</span>*x[<span class="number">16</span>] + <span class="number">3</span>*x[<span class="number">13</span>] + <span class="number">88</span>*x[<span class="number">10</span>] +</span><br><span class="line">    <span class="number">39</span>*x[<span class="number">8</span>] + <span class="number">48</span>*x[<span class="number">7</span>] + <span class="number">74</span>*x[<span class="number">6</span>] + <span class="number">86</span>*x[<span class="number">4</span>] + <span class="number">46</span>*x[<span class="number">2</span>] + <span class="number">17</span>*x[<span class="number">0</span>] -</span><br><span class="line">    <span class="number">98</span>*x[<span class="number">1</span>] - <span class="number">50</span>*x[<span class="number">3</span>] - <span class="number">28</span>*x[<span class="number">5</span>] - <span class="number">73</span>*x[<span class="number">9</span>] - <span class="number">33</span>*x[<span class="number">11</span>] - <span class="number">75</span>*x[<span class="number">12</span>] - <span class="number">14</span>*x[<span class="number">14</span>] -</span><br><span class="line">    <span class="number">31</span>*x[<span class="number">15</span>] - <span class="number">26</span>*x[<span class="number">18</span>] - <span class="number">52</span>*x[<span class="number">21</span>] == <span class="number">8283</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">s.add(</span><br><span class="line">    <span class="number">96</span>*x[<span class="number">22</span>] + <span class="number">85</span>*x[<span class="number">20</span>] + <span class="number">55</span>*x[<span class="number">19</span>] + <span class="number">99</span>*x[<span class="number">13</span>] + <span class="number">19</span>*x[<span class="number">11</span>] + <span class="number">77</span>*x[<span class="number">10</span>] + <span class="number">52</span>*x[<span class="number">9</span>] +</span><br><span class="line">    <span class="number">66</span>*x[<span class="number">8</span>] + <span class="number">96</span>*x[<span class="number">6</span>] + <span class="number">72</span>*x[<span class="number">4</span>] + <span class="number">90</span>*x[<span class="number">3</span>] + <span class="number">60</span>*x[<span class="number">1</span>] + <span class="number">94</span>*x[<span class="number">0</span>] -</span><br><span class="line">    <span class="number">99</span>*x[<span class="number">2</span>] - <span class="number">26</span>*x[<span class="number">5</span>] - <span class="number">94</span>*x[<span class="number">7</span>] - <span class="number">49</span>*x[<span class="number">12</span>] - <span class="number">32</span>*x[<span class="number">14</span>] - <span class="number">54</span>*x[<span class="number">15</span>] - <span class="number">92</span>*x[<span class="number">16</span>] -</span><br><span class="line">    <span class="number">71</span>*x[<span class="number">17</span>] - <span class="number">63</span>*x[<span class="number">18</span>] - <span class="number">23</span>*x[<span class="number">21</span>] == <span class="number">33789</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">s.add(</span><br><span class="line">    <span class="number">15</span>*x[<span class="number">22</span>] + x[<span class="number">19</span>] + <span class="number">26</span>*x[<span class="number">17</span>] + <span class="number">65</span>*x[<span class="number">16</span>] + <span class="number">80</span>*x[<span class="number">11</span>] + <span class="number">92</span>*x[<span class="number">8</span>] + <span class="number">28</span>*x[<span class="number">5</span>] +</span><br><span class="line">    <span class="number">79</span>*x[<span class="number">4</span>] + <span class="number">73</span>*x[<span class="number">0</span>] -</span><br><span class="line">    <span class="number">98</span>*x[<span class="number">1</span>] - <span class="number">2</span>*x[<span class="number">2</span>] - <span class="number">70</span>*x[<span class="number">3</span>] - <span class="number">10</span>*x[<span class="number">6</span>] - <span class="number">30</span>*x[<span class="number">7</span>] - <span class="number">51</span>*x[<span class="number">9</span>] - <span class="number">77</span>*x[<span class="number">10</span>] -</span><br><span class="line">    <span class="number">32</span>*x[<span class="number">12</span>] - <span class="number">32</span>*x[<span class="number">13</span>] + <span class="number">8</span>*x[<span class="number">14</span>] + <span class="number">4</span>*x[<span class="number">15</span>] - <span class="number">11</span>*x[<span class="number">18</span>] - <span class="number">83</span>*x[<span class="number">20</span>] - <span class="number">85</span>*x[<span class="number">21</span>] == -<span class="number">10455</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    m = s.model()</span><br><span class="line">    x_vals = [m[x[i]].as_long() <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">23</span>)]</span><br><span class="line">    flag_bytes = <span class="built_in">bytes</span>([xi ^ <span class="number">0xC</span> <span class="keyword">for</span> xi <span class="keyword">in</span> x_vals])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Flag:&quot;</span>, flag_bytes.decode(<span class="string">&#x27;ascii&#x27;</span>))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;No solution!&quot;</span>)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># Flag: ISCTF&#123;yR_A_Zzz_Ma5t3R!&#125;</span></span><br></pre></td></tr></table></figure></div>



<h4 id="ezpy"><a href="#ezpy" class="headerlink" title="ezpy"></a>ezpy</h4><hr>
<p>题目描述：这是什么库？没见过呢</p>
<hr>
<p>下载附件，是pyinstaller处理的<code>ezpy.exe</code>，按照之前做法，得到<code>extracted</code>文件夹，</p>
<p>反编译<code>ezpy.pyc</code>得到：</p>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">from</span> mypy <span class="keyword">import</span> check</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    user_input = <span class="built_in">input</span>(<span class="string">&#x27;Please input your flag: &#x27;</span>).strip()</span><br><span class="line">    <span class="keyword">if</span> check(user_input):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Correct!&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line"><span class="keyword">except</span> ImportError:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Error: Cannot import mypy module&#x27;</span>)</span><br><span class="line">    exit(<span class="number">1</span>)</span><br></pre></td></tr></table></figure></div>

<p>没什么用，继续找。在目录里看到了<code>mypy.cp313-win_amd64.pyd</code>，想着用IDA反编译试试…</p>
<p>在IDA中，<code>Shift+F12</code>看到<code>RC4 flag checker module</code>，得到是<strong>RC4加密</strong>，</p>
<p>通过一个一个函数查看的艰难寻找，在<code>sub_36F4D1519</code>函数中得到RC4加密的密钥<code>ISCTF2025</code>：</p>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  char *v2; // rsi</span><br><span class="line">  __m128i *v3; // rbx</span><br><span class="line">  __m128i *v5; // rax</span><br><span class="line">  unsigned <span class="built_in">int</span> v6; // eax</span><br><span class="line">  __int64 v7; // rax</span><br><span class="line">  char v8[<span class="number">274</span>]; // [rsp+26h] [rbp-132h] BYREF</span><br><span class="line">  char *Str; // [rsp+138h] [rbp-20h] BYREF</span><br><span class="line"></span><br><span class="line">  strcpy(v8, <span class="string">&quot;ISCTF2025&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !(unsigned <span class="built_in">int</span>)PyArg_ParseTuple(a2, &amp;unk_36F4D4000, &amp;Str) )</span><br><span class="line">    <span class="keyword">return</span> 0LL;</span><br><span class="line">  v2 = Str;</span><br><span class="line">  v3 = (__m128i *)Py_FalseStruct;</span><br><span class="line">  <span class="keyword">if</span> ( (unsigned <span class="built_in">int</span>)strlen(Str) == <span class="number">25</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = (__m128i *)malloc(0x19uLL);</span><br><span class="line">    v3 = v5;</span><br><span class="line">    <span class="keyword">if</span> ( v5 )</span><br><span class="line">    &#123;</span><br><span class="line">      *v5 = _mm_loadu_si128((const __m128i *)v2);</span><br><span class="line">      *(__m128i *)((char *)v5 + <span class="number">9</span>) = _mm_loadu_si128((const __m128i *)(v2 + <span class="number">9</span>));</span><br><span class="line">      v6 = strlen(v8);</span><br><span class="line">      sub_36F4D1430(&amp;v8[<span class="number">10</span>], v8, v6);</span><br><span class="line">      sub_36F4D149C(&amp;v8[<span class="number">10</span>], v3, 25LL);</span><br><span class="line">      v7 = 0LL;</span><br><span class="line">      <span class="keyword">while</span> ( v3-&gt;m128i_i8[v7] == byte_36F4D4050[v7] )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( ++v7 == <span class="number">25</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          free(v3);</span><br><span class="line">          <span class="keyword">return</span> (__m128i *)Py_TrueStruct;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      free(v3);</span><br><span class="line">      <span class="keyword">return</span> (__m128i *)Py_FalseStruct;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      PyErr_NoMemory();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v3;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>生成<strong>RC4的S-box</strong>，写入<code>v8[i]</code>，然后执行<code>cipher[i] = plain[i] XOR RC4_next()</code>。</p>
<p>查看汇编代码，得到<code>byte_36F4D4050</code>的数据：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="/images/ISCTF-re1.png"
                      alt="re1"
                ></p>
<p>最终的EXP：</p>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line">cipher = <span class="built_in">bytes</span>([</span><br><span class="line">    <span class="number">0x1D</span>,<span class="number">0xD5</span>,<span class="number">0x38</span>,<span class="number">0x33</span>,<span class="number">0xAF</span>,<span class="number">0xB5</span>,<span class="number">0x51</span>,<span class="number">0xF3</span>,<span class="number">0x2C</span>,<span class="number">0x6B</span>,</span><br><span class="line">    <span class="number">0x6E</span>,<span class="number">0xFE</span>,<span class="number">0x41</span>,<span class="number">0x24</span>,<span class="number">0x43</span>,<span class="number">0xD2</span>,<span class="number">0x71</span>,<span class="number">0xCF</span>,<span class="number">0xA4</span>,<span class="number">0x4C</span>,</span><br><span class="line">    <span class="number">0xE3</span>,<span class="number">0x9A</span>,<span class="number">0x9A</span>,<span class="number">0xB5</span>,<span class="number">0x31</span></span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">key = <span class="string">b&quot;ISCTF2025&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_ksa</span>(<span class="params">key</span>):</span><br><span class="line">    S = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (j + S[i] + key[i % <span class="built_in">len</span>(key)]) &amp; <span class="number">0xFF</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line">    <span class="keyword">return</span> S</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_prga</span>(<span class="params">S, n</span>):</span><br><span class="line">    i = j = <span class="number">0</span></span><br><span class="line">    out = []</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        i = (i + <span class="number">1</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">        j = (j + S[i]) &amp; <span class="number">0xFF</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line">        K = S[(S[i] + S[j]) &amp; <span class="number">0xFF</span>]</span><br><span class="line">        out.append(K)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(out)</span><br><span class="line"></span><br><span class="line">S = rc4_ksa(key)</span><br><span class="line">keystream = rc4_prga(S, <span class="built_in">len</span>(cipher))</span><br><span class="line"></span><br><span class="line">plain = <span class="built_in">bytes</span>([c ^ k <span class="keyword">for</span> c, k <span class="keyword">in</span> <span class="built_in">zip</span>(cipher, keystream)])</span><br><span class="line"><span class="built_in">print</span>(plain)</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag: ISCTF&#123;Y0U_GE7_7HE_PYD!!!&#125;</span></span><br></pre></td></tr></table></figure></div>



<h4 id="MysteriousStream"><a href="#MysteriousStream" class="headerlink" title="MysteriousStream"></a>MysteriousStream</h4><hr>
<p>题目描述：小曲冒着生命风险，读入了一个神秘的 payload.dat文件，为了不枉费小曲的艰辛……，你能逆向出被加密的秘密吗？</p>
<hr>
<p>下载附件，包含<code>challenge</code>和<code>payload.dat</code>文件，定位至<code>main</code>函数：</p>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  FILE *v3; // rax</span><br><span class="line">  FILE *v4; // r12</span><br><span class="line">  signed __int64 v5; // r14</span><br><span class="line">  char *v6; // rax</span><br><span class="line">  char *v7; // rbp</span><br><span class="line">  size_t v8; // r13</span><br><span class="line">  __int64 i; // rcx</span><br><span class="line">  _BYTE v11[<span class="number">17</span>]; // [rsp+7h] [rbp-41h] BYREF</span><br><span class="line">  unsigned __int64 v12; // [rsp+18h] [rbp-30h]</span><br><span class="line"></span><br><span class="line">  v12 = __readfsqword(0x28u);</span><br><span class="line">  v3 = fopen(<span class="string">&quot;payload.dat&quot;</span>, <span class="string">&quot;rb&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v3 )</span><br><span class="line">  &#123;</span><br><span class="line">    v4 = v3;</span><br><span class="line">    fseek(v3, 0LL, <span class="number">2</span>);</span><br><span class="line">    v5 = ftell(v4);</span><br><span class="line">    <span class="keyword">if</span> ( v5 &lt; <span class="number">0</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      puts(<span class="string">&quot;Get file size failed&quot;</span>);</span><br><span class="line">      fclose(v4);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      fseek(v4, 0LL, <span class="number">0</span>);</span><br><span class="line">      v6 = (char *)malloc(v5);</span><br><span class="line">      v7 = v6;</span><br><span class="line">      <span class="keyword">if</span> ( v6 )</span><br><span class="line">      &#123;</span><br><span class="line">        v8 = fread(v6, 1uLL, v5, v4);</span><br><span class="line">        fclose(v4);</span><br><span class="line">        <span class="keyword">if</span> ( v5 == v8 )</span><br><span class="line">        &#123;</span><br><span class="line">          qmemcpy(v11, <span class="string">&quot;P4ssXORSecr3tK3y!&quot;</span>, sizeof(v11));</span><br><span class="line">          rc4_variant(v7, v8, &amp;v11[<span class="number">7</span>], 10LL);</span><br><span class="line">          <span class="keyword">if</span> ( v8 )</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">for</span> ( i = 0LL; i != v8; ++i )</span><br><span class="line">              v7[i] ^= v11[i % <span class="number">7</span>];</span><br><span class="line">          &#125;</span><br><span class="line">          __printf_chk(1LL, <span class="string">&quot;Result: %s\n&quot;</span>, v7);</span><br><span class="line">          free(v7);</span><br><span class="line">          <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          __printf_chk(1LL, <span class="string">&quot;Read failed! Expected %ld bytes, got %zu bytes\n&quot;</span>, v5, v8);</span><br><span class="line">          free(v7);</span><br><span class="line">          <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        puts(<span class="string">&quot;Malloc memory failed&quot;</span>);</span><br><span class="line">        fclose(v4);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    puts(<span class="string">&quot;payload.dat not found&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>使用<code>key = v11[7 : 7 + 10] = &quot;Secr3tK3y!&quot;</code>加密，对payload (v7) 做RC4加密，</p>
<p>然后循环异或<code>key_xor = v11[0:7] = b&quot;P4ssXOR&quot;</code>和<code>v7[i] = v7[i] XOR key_xor[i % 7]</code>，</p>
<p>再看<code>xor_cycle</code>函数：</p>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  unsigned __int64 i; // r8</span><br><span class="line">  __int64 result; // rax</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( a2 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = 0LL; i != a2; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      result = *(unsigned __int8 *)(a3 + i % a4);</span><br><span class="line">      *(_BYTE *)(a1 + i) ^= result;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>和<code>rc4_variant</code>函数：</p>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  _BYTE *v4; // r8</span><br><span class="line">  __int64 i; // rax</span><br><span class="line">  unsigned __int64 v7; // rcx</span><br><span class="line">  <span class="built_in">int</span> v8; // ebx</span><br><span class="line">  char v9; // r11</span><br><span class="line">  _BYTE *v10; // r9</span><br><span class="line">  char v11; // al</span><br><span class="line">  _BYTE v13[<span class="number">264</span>]; // [rsp+0h] [rbp-118h]</span><br><span class="line">  unsigned __int64 v14; // [rsp+108h] [rbp-10h]</span><br><span class="line"></span><br><span class="line">  v4 = a1;</span><br><span class="line">  v14 = __readfsqword(0x28u);</span><br><span class="line">  <span class="keyword">for</span> ( i = 0LL; i != <span class="number">256</span>; ++i )</span><br><span class="line">    v13[i] = i;</span><br><span class="line">  v7 = 0LL;</span><br><span class="line">  LOBYTE(v8) = <span class="number">0</span>;</span><br><span class="line">  do</span><br><span class="line">  &#123;</span><br><span class="line">    v9 = v13[v7];</span><br><span class="line">    v8 = (unsigned __int8)((v7 &amp; <span class="number">0xAA</span>) + v8 + v9 + *(_BYTE *)(a3 + v7 % a4));</span><br><span class="line">    v13[v7++] = v13[v8];</span><br><span class="line">    v13[v8] = v9;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v7 != <span class="number">256</span> );</span><br><span class="line">  <span class="keyword">if</span> ( a2 )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = &amp;a1[a2];</span><br><span class="line">    LOBYTE(a1) = <span class="number">0</span>;</span><br><span class="line">    LOBYTE(a2) = <span class="number">0</span>;</span><br><span class="line">    do</span><br><span class="line">    &#123;</span><br><span class="line">      LODWORD(a1) = (unsigned __int8)((_BYTE)a1 + <span class="number">1</span>);</span><br><span class="line">      v11 = v13[(unsigned <span class="built_in">int</span>)a1];</span><br><span class="line">      LODWORD(a2) = (unsigned __int8)(v11 + a2);</span><br><span class="line">      v13[(unsigned <span class="built_in">int</span>)a1] = v13[(unsigned <span class="built_in">int</span>)a2];</span><br><span class="line">      v13[(unsigned <span class="built_in">int</span>)a2] = v11;</span><br><span class="line">      *v4++ ^= v13[(unsigned __int8)(v13[(unsigned <span class="built_in">int</span>)a1] + v11)];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v10 != v4 );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v14 - __readfsqword(0x28u);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>变种的RC4加密逻辑为<code>j = (j + S[i] + key[i % keylen] + (i &amp; 0xAA)) mod 256</code>，解密只需逆着来即可。</p>
<p>所以，最终的加密逻辑为<code>cipher = XOR( RC4_variant(plaintext, key=&quot;Secr3tK3y!&quot;) , key=&quot;P4ssXOR&quot;)</code>。</p>
<p>EXP：</p>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_variant_crypt</span>(<span class="params">data: <span class="built_in">bytes</span>, key: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    </span><br><span class="line">    S = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    key_len = <span class="built_in">len</span>(key)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = ( (i &amp; <span class="number">0xAA</span>) + j + S[i] + key[i % key_len] ) &amp; <span class="number">0xFF</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line"></span><br><span class="line">    out = <span class="built_in">bytearray</span>()</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> byte <span class="keyword">in</span> data:</span><br><span class="line">        i = (i + <span class="number">1</span>) &amp; <span class="number">0xFF</span></span><br><span class="line">        j = (j + S[i]) &amp; <span class="number">0xFF</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line">        K = S[(S[i] + S[j]) &amp; <span class="number">0xFF</span>]</span><br><span class="line">        out.append(byte ^ K)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(out)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">cipher: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    xor_key = <span class="string">b&quot;P4ssXOR&quot;</span></span><br><span class="line">    rc4_key = <span class="string">b&quot;Secr3tK3y!&quot;</span></span><br><span class="line"></span><br><span class="line">    tmp = <span class="built_in">bytearray</span>(<span class="built_in">len</span>(cipher))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cipher)):</span><br><span class="line">        tmp[i] = cipher[i] ^ xor_key[i % <span class="built_in">len</span>(xor_key)]</span><br><span class="line"></span><br><span class="line">    plain = rc4_variant_crypt(tmp, rc4_key)</span><br><span class="line">    <span class="keyword">return</span> plain</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;D:\\MysteriousStream\\payload.dat&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        cipher = f.read()</span><br><span class="line">    plaintext = decrypt(cipher)</span><br><span class="line">    <span class="built_in">print</span>(plaintext.decode(errors=<span class="string">&quot;ignore&quot;</span>))</span><br><span class="line">    </span><br><span class="line"><span class="comment"># flag: ISCTF&#123;Y0u_a2e_2ea11y_a_1aby2inth_master&#125;</span></span><br></pre></td></tr></table></figure></div>



<h3 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h3><h4 id="easy-RSA"><a href="#easy-RSA" class="headerlink" title="easy_RSA"></a>easy_RSA</h4><hr>
<p>题目描述：我们的爱情像欧拉函数φ(n)——无限趋近却永远达不到n的完美互质，最终只剩周期性的怀念在模n的世界里循环证明</p>
<hr>
<p>下载加密代码：</p>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">N = p*q</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">msg = bytes_to_long(<span class="string">b&quot;ISCTF&#123;dummy_flag&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line">ct1 = <span class="built_in">pow</span>(msg, e, N)</span><br><span class="line"></span><br><span class="line">ct2 = <span class="built_in">pow</span>(msg, p+q, N)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;N = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;ct1 = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;ct2 = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">N = 17630258257080557797062320474423515967705950026415012912087655679315479168903980901728425140787005046038000068414269936806478828260848859753400786557270120330760791255046985114127285672634413513991988895166115794242018674042563788348381567565190146278040811257757119090296478610798393944581870309373529884950663990485525646200034220648901490835962964029936321155200390798215987316069871958913773199197073860062515329879288106446016695204426001393566351524023857332978260894409698596465474214898402707157933326431896629025197964209580991821222557663589475589423032130993456522178540455360695933336455068507071827928617</span></span><br><span class="line"><span class="string">ct1 = 5961639119243884817956362325106436035547108981120248145301572089585639543543496627985540773185452108709958107818159430835510386993354596106366458898765597405461225798615020342640056386757104855709899089816838805631480329264128349465229327090721088394549641366346516133008681155817222994359616737681983784274513555455340301061302815102944083173679173923728968671113926376296481298323500774419099682647601977970777260084799036306508597807029122276595080580483336115458713338522372181732208078117809553781889555191883178157241590455408910096212697893247529197116309329028589569527960811338838624831855672463438531266455</span></span><br><span class="line"><span class="string">ct2 = 11792054298654397865983651507912282632831471680334312509918945120797862876661899077559686851237832931501121869814783150387308320349940383857026679141830402807715397332316601439614741315278033853646418275632174160816784618982743834204997402866931295619202826633629690164429512723957241072421663170829944076753483616865208617479794763412611604625495201470161813033934476868949612651276104339747165276204945125001274777134529491152840672010010940034503257315555511274325831684793040209224816879778725612468542758777428888563266233284958660088175139114166433501743740034567850893745466521144371670962121062992082312948789</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure></div>

<p>是RSA中的共模攻击，<code>m = c1 ^ s1 * c2 ^ s2 mod N</code>，</p>
<p>得到EXP：</p>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, inverse</span><br><span class="line"></span><br><span class="line">N = <span class="number">17630258257080557797062320474423515967705950026415012912087655679315479168903980901728425140787005046038000068414269936806478828260848859753400786557270120330760791255046985114127285672634413513991988895166115794242018674042563788348381567565190146278040811257757119090296478610798393944581870309373529884950663990485525646200034220648901490835962964029936321155200390798215987316069871958913773199197073860062515329879288106446016695204426001393566351524023857332978260894409698596465474214898402707157933326431896629025197964209580991821222557663589475589423032130993456522178540455360695933336455068507071827928617</span></span><br><span class="line">ct1 = <span class="number">5961639119243884817956362325106436035547108981120248145301572089585639543543496627985540773185452108709958107818159430835510386993354596106366458898765597405461225798615020342640056386757104855709899089816838805631480329264128349465229327090721088394549641366346516133008681155817222994359616737681983784274513555455340301061302815102944083173679173923728968671113926376296481298323500774419099682647601977970777260084799036306508597807029122276595080580483336115458713338522372181732208078117809553781889555191883178157241590455408910096212697893247529197116309329028589569527960811338838624831855672463438531266455</span></span><br><span class="line">ct2 = <span class="number">11792054298654397865983651507912282632831471680334312509918945120797862876661899077559686851237832931501121869814783150387308320349940383857026679141830402807715397332316601439614741315278033853646418275632174160816784618982743834204997402866931295619202826633629690164429512723957241072421663170829944076753483616865208617479794763412611604625495201470161813033934476868949612651276104339747165276204945125001274777134529491152840672010010940034503257315555511274325831684793040209224816879778725612468542758777428888563266233284958660088175139114166433501743740034567850893745466521144371670962121062992082312948789</span></span><br><span class="line"></span><br><span class="line">e1 = <span class="number">65537</span></span><br><span class="line">e2 = N + <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extended_gcd</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> b, <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        g, y, x = extended_gcd(b % a, a)</span><br><span class="line">        <span class="keyword">return</span> g, x - (b // a) * y, y</span><br><span class="line"></span><br><span class="line">g, s1, s2 = extended_gcd(e1, e2)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[*] gcd(e1, e2) = <span class="subst">&#123;g&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[*] s1 = <span class="subst">&#123;s1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[*] s2 = <span class="subst">&#123;s2&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s1 &gt; <span class="number">0</span>:</span><br><span class="line">    part1 = <span class="built_in">pow</span>(ct1, s1, N)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    part1 = <span class="built_in">pow</span>(inverse(ct1, N), -s1, N)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s2 &gt; <span class="number">0</span>:</span><br><span class="line">    part2 = <span class="built_in">pow</span>(ct2, s2, N)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    part2 = <span class="built_in">pow</span>(inverse(ct2, N), -s2, N)</span><br><span class="line"></span><br><span class="line">msg_int = (part1 * part2) % N</span><br><span class="line">flag = long_to_bytes(msg_int)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;-&quot;</span> * <span class="number">30</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[*] Decrypted Flag: <span class="subst">&#123;flag&#125;</span>&quot;</span>)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[*] Decoded: <span class="subst">&#123;flag.decode()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;-&quot;</span> * <span class="number">30</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag: ISCTF&#123;Congratulations_you_master_Mathematical_ability&#125;</span></span><br></pre></td></tr></table></figure></div>



<h4 id="小蓝鲨的LFSR系统"><a href="#小蓝鲨的LFSR系统" class="headerlink" title="小蓝鲨的LFSR系统"></a>小蓝鲨的LFSR系统</h4><hr>
<p>题目描述：”小蓝鲨是海洋情报局的新晋密码专家，它设计了一个基于LFSR的流密码系统来加密机密信息。这个系统看起来简单高效，但小蓝鲨不知道的是，LFSR在某些情况下可能存在安全隐患。 一天，小蓝鲨的加密系统被神秘的黑客组织””深海幽灵””入侵，他们截获了一段加密信息。作为海洋安全部门的成员，你需要分析这个加密系统，找出潜在的弱点，并解密被截获的信息。”</p>
<hr>
<p>打开附件：</p>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> secrets</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">simple_lfsr_encrypt</span>(<span class="params">plaintext, init_state</span>):</span><br><span class="line">    mask = [random.randint(<span class="number">0</span>,<span class="number">1</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>)]</span><br><span class="line">    </span><br><span class="line">    state = init_state.copy()</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        feedback = <span class="built_in">sum</span>(state[i] &amp; mask[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>)) % <span class="number">2</span></span><br><span class="line">        state.append(feedback)</span><br><span class="line">    </span><br><span class="line">    key = <span class="built_in">bytes</span>(<span class="built_in">int</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">str</span>(bit) <span class="keyword">for</span> bit <span class="keyword">in</span> mask[i*<span class="number">8</span>:(i+<span class="number">1</span>)*<span class="number">8</span>]), <span class="number">2</span>) </span><br><span class="line">               <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>))</span><br><span class="line">    </span><br><span class="line">    keystream = (key * (<span class="built_in">len</span>(plaintext)//<span class="number">16</span> + <span class="number">1</span>))[:<span class="built_in">len</span>(plaintext)]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(p ^ k <span class="keyword">for</span> p, k <span class="keyword">in</span> <span class="built_in">zip</span>(plaintext, keystream)), mask</span><br></pre></td></tr></table></figure></div>

<p>和对应的输出文件：</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">initState = [0, 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0]</span><br><span class="line">outputState = [0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 1, 0, 0, 1, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1]</span><br><span class="line">ciphertext = &#x27;4b3be165a0a0edd67ca8f143884826725107fd42d6a6&#x27;</span><br></pre></td></tr></table></figure></div>

<p>构造线性方程组<code>A * X = B</code>，在GF(2)域上使用<strong>高斯消元法</strong>解出<code>mask</code>，</p>
<p>EXP：</p>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">initState = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">outputState = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">ciphertext_hex = <span class="string">&#x27;4b3be165a0a0edd67ca8f143884826725107fd42d6a6&#x27;</span></span><br><span class="line"></span><br><span class="line">full_stream = initState + outputState</span><br><span class="line">N = <span class="number">128</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gaussian_elimination_gf2</span>(<span class="params">A, B</span>):</span><br><span class="line">    rows = <span class="built_in">len</span>(A)</span><br><span class="line">    cols = <span class="built_in">len</span>(A[<span class="number">0</span>])</span><br><span class="line">    aug_matrix = [row + [B[i]] <span class="keyword">for</span> i, row <span class="keyword">in</span> <span class="built_in">enumerate</span>(A)]</span><br><span class="line">    </span><br><span class="line">    pivot_row = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(cols):</span><br><span class="line">        <span class="keyword">if</span> pivot_row &gt;= rows: <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> aug_matrix[pivot_row][col] == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(pivot_row + <span class="number">1</span>, rows):</span><br><span class="line">                <span class="keyword">if</span> aug_matrix[i][col] == <span class="number">1</span>:</span><br><span class="line">                    aug_matrix[pivot_row], aug_matrix[i] = aug_matrix[i], aug_matrix[pivot_row]</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>: <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(rows):</span><br><span class="line">            <span class="keyword">if</span> i != pivot_row <span class="keyword">and</span> aug_matrix[i][col] == <span class="number">1</span>:</span><br><span class="line">                aug_matrix[i] = [x ^ y <span class="keyword">for</span> x, y <span class="keyword">in</span> <span class="built_in">zip</span>(aug_matrix[i], aug_matrix[pivot_row])]</span><br><span class="line">        pivot_row += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    solution = [<span class="number">0</span>] * cols</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(rows):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            pivot_col = aug_matrix[i][:-<span class="number">1</span>].index(<span class="number">1</span>)</span><br><span class="line">            solution[pivot_col] = aug_matrix[i][-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">except</span> ValueError: <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">return</span> solution</span><br><span class="line"></span><br><span class="line">matrix = []</span><br><span class="line">results = []</span><br><span class="line">num_equations = <span class="built_in">len</span>(outputState) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[*] Building <span class="subst">&#123;num_equations&#125;</span> equations from stream...&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">min</span>(num_equations, N + <span class="number">20</span>)):</span><br><span class="line">    row = full_stream[i : i + N]</span><br><span class="line">    res = full_stream[i + N]</span><br><span class="line">    matrix.append(row)</span><br><span class="line">    results.append(res)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[*] Solving for Mask via Gaussian Elimination...&quot;</span>)</span><br><span class="line">mask = gaussian_elimination_gf2(matrix, results)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[*] Verifying Mask...&quot;</span>, end=<span class="string">&quot; &quot;</span>)</span><br><span class="line">state_test = initState.copy()</span><br><span class="line">generated_test = []</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(outputState)):</span><br><span class="line">    feedback = <span class="built_in">sum</span>(state_test[k] &amp; mask[k] <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>)) % <span class="number">2</span></span><br><span class="line">    state_test.append(feedback)</span><br><span class="line"></span><br><span class="line">check_pass = <span class="literal">True</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(outputState)):</span><br><span class="line">    prediction = <span class="built_in">sum</span>(full_stream[i+k] &amp; mask[k] <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>)) % <span class="number">2</span></span><br><span class="line">    <span class="keyword">if</span> prediction != outputState[i]:</span><br><span class="line">        check_pass = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> check_pass:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;SUCCESS! Mask perfectly regenerates the output.&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;WARNING: Mask verification failed. The LFSR logic might differ.&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_with_mode</span>(<span class="params">mask_bits, ct_hex, mode_name</span>):</span><br><span class="line">    key_bytes = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        bits = mask_bits[i*<span class="number">8</span> : (i+<span class="number">1</span>)*<span class="number">8</span>]</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;Little&quot;</span> <span class="keyword">in</span> mode_name:</span><br><span class="line">            bits = bits[::-<span class="number">1</span>]</span><br><span class="line">        </span><br><span class="line">        val = <span class="built_in">int</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">str</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> bits), <span class="number">2</span>)</span><br><span class="line">        key_bytes.append(val)</span><br><span class="line">    </span><br><span class="line">    key = <span class="built_in">bytes</span>(key_bytes)</span><br><span class="line">    ct = binascii.unhexlify(ct_hex)</span><br><span class="line">    keystream = (key * (<span class="built_in">len</span>(ct)//<span class="number">16</span> + <span class="number">1</span>))[:<span class="built_in">len</span>(ct)]</span><br><span class="line">    pt = <span class="built_in">bytes</span>(c ^ k <span class="keyword">for</span> c, k <span class="keyword">in</span> <span class="built_in">zip</span>(ct, keystream))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        pt_text = pt.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;ISCTF&#123;&quot;</span> <span class="keyword">in</span> pt_text <span class="keyword">or</span> <span class="string">&quot;uuid&quot;</span> <span class="keyword">in</span> pt_text <span class="keyword">or</span> <span class="string">&quot;&#123;&quot;</span> <span class="keyword">in</span> pt_text:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;\n[+] SUCCESS (<span class="subst">&#123;mode_name&#125;</span>): <span class="subst">&#123;pt_text&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">all</span>(<span class="number">32</span> &lt;= c &lt;= <span class="number">126</span> <span class="keyword">for</span> c <span class="keyword">in</span> pt):</span><br><span class="line">                 <span class="built_in">print</span>(<span class="string">f&quot;\n[?] Possible Candidate (<span class="subst">&#123;mode_name&#125;</span>): <span class="subst">&#123;pt_text&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">return</span> pt</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;-&quot;</span> * <span class="number">30</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[*] Attempting Decryption...&quot;</span>)</span><br><span class="line"></span><br><span class="line">res1 = decrypt_with_mode(mask, ciphertext_hex, <span class="string">&quot;Standard Big-Endian&quot;</span>)</span><br><span class="line">res2 = decrypt_with_mode(mask, ciphertext_hex, <span class="string">&quot;Little-Endian Bits&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;-&quot;</span> * <span class="number">30</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Key (Hex): <span class="subst">&#123;<span class="built_in">bytes</span>(<span class="built_in">int</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">str</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> mask[i*<span class="number">8</span>:(i+<span class="number">1</span>)*<span class="number">8</span>]), <span class="number">2</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)).<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag: ISCTF&#123;lf5R_jUst_So_s0&#125;</span></span><br></pre></td></tr></table></figure></div>



<h4 id="小蓝鲨的RSA密文"><a href="#小蓝鲨的RSA密文" class="headerlink" title="小蓝鲨的RSA密文"></a>小蓝鲨的RSA密文</h4><hr>
<p>题目描述：”小蓝鲨是海洋数学天才，它最近正在深耕RSA领域。你嗤之以鼻，心想RSA不是最基础的密码学知识吗？于是你信誓旦旦的跑到小蓝鲨面前告诉它你已经完全掌握了RSA，并宣称所有的RSA题目你都能做出来。 小蓝鲨意味深长的看了你一眼，并出了一道RSA来考考你。现在，该你向它证明你的实力了。”</p>
<hr>
<p>打开.py文件，</p>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> json, secrets</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">N = getPrime(<span class="number">512</span>) * getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">a2_high = a2 &gt;&gt; LOW_BITS</span><br><span class="line"></span><br><span class="line">aes_key = secrets.token_bytes(<span class="number">16</span>)</span><br><span class="line">m = bytes_to_long(aes_key)</span><br><span class="line"></span><br><span class="line">f = a2 * (m * m) + a1 * m + a0</span><br><span class="line"></span><br><span class="line">c = (<span class="built_in">pow</span>(m, e) + f) % N</span><br><span class="line"></span><br><span class="line">iv = secrets.token_bytes(<span class="number">16</span>)</span><br><span class="line">cipher = AES.new(aes_key, AES.MODE_CBC, iv=iv)</span><br><span class="line">ct = cipher.encrypt(pad(FLAG, <span class="number">16</span>))</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">N = 121288600621198389662246479277632294800423697823363188896668775456771641807233781416525282234787873435904747571468452950479817935684848143651716343606633656969395065588423982440884464542428742861388200306417822228591316703916504170245990423925894477848679490979364923848426643149659758241239900845544537886777</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">c = 3756824985347508967549776773725045773059311839370527149219720084008312247164501688241698562854942756369420003479117</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">a2_high = 9012778</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">LOW_BITS = 16</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">a1 = 621315</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">a0 = 452775142</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">iv = bf38e64bb5c1b069a07b7d1d046a9010</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ct = 8966006c4724faf53883b56a1a8a08ee17b1535e1657c16b3b129ee2d2e389744c943014eb774cd24a5d0f7ad140276fdec72eb985b6de67b8e4674b0bcdc4a5</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure></div>

<p>模数N(两512位素数乘积）<strong>过大</strong>，而<code>m(AES-key)</code>只有128位</p>
<p>我们可以采用爆破<code>low_bits</code>，遍历<code>0 - 65535</code>的所有可能值，构造完整的<code>a2</code>；再求解三次方程<code>m^3 + a2*m^2 + a1*m + (a0 - c) = 0</code>；用<strong>二分查找</strong>找到<code>m</code>；最后，用找到的密钥<code>m</code>解密<code>ct</code>即可得到flag。</p>
<p>EXP：</p>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> unpad</span><br><span class="line"></span><br><span class="line">c = <span class="number">3756824985347508967549776773725045773059311839370527149219720084008312247164501688241698562854942756369420003479117</span></span><br><span class="line">a2_high = <span class="number">9012778</span></span><br><span class="line">LOW_BITS = <span class="number">16</span></span><br><span class="line">a1 = <span class="number">621315</span></span><br><span class="line">a0 = <span class="number">452775142</span></span><br><span class="line">iv_hex = <span class="string">&quot;bf38e64bb5c1b069a07b7d1d046a9010&quot;</span></span><br><span class="line">ct_hex = <span class="string">&quot;8966006c4724faf53883b56a1a8a08ee17b1535e1657c16b3b129ee2d2e389744c943014eb774cd24a5d0f7ad140276fdec72eb985b6de67b8e4674b0bcdc4a5&quot;</span></span><br><span class="line"></span><br><span class="line">iv = <span class="built_in">bytes</span>.fromhex(iv_hex)</span><br><span class="line">ct = <span class="built_in">bytes</span>.fromhex(ct_hex)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_cubic_for_m</span>(<span class="params">target_a2</span>):</span><br><span class="line">    low = <span class="number">0</span></span><br><span class="line">    high = <span class="number">1</span> &lt;&lt; <span class="number">130</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> low &lt;= high:</span><br><span class="line">        mid = (low + high) // <span class="number">2</span></span><br><span class="line">        val = mid**<span class="number">3</span> + target_a2 * (mid**<span class="number">2</span>) + a1 * mid + a0</span><br><span class="line">        <span class="keyword">if</span> val == c:</span><br><span class="line">            <span class="keyword">return</span> mid</span><br><span class="line">        <span class="keyword">elif</span> val &lt; c:</span><br><span class="line">            low = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            high = mid - <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[*] 开始爆破 a2 的低 16 位...&quot;</span>)</span><br><span class="line"></span><br><span class="line">found_m = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> low_part <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**LOW_BITS):</span><br><span class="line"></span><br><span class="line">    current_a2 = (a2_high &lt;&lt; LOW_BITS) + low_part</span><br><span class="line">    res = solve_cubic_for_m(current_a2)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> res <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        found_m = res</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[+] 找到唯一解 m: <span class="subst">&#123;found_m&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[+] 对应的 a2 低位为: <span class="subst">&#123;low_part&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> found_m:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        aes_key = long_to_bytes(found_m)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(aes_key) &lt; <span class="number">16</span>:</span><br><span class="line">            aes_key = aes_key.rjust(<span class="number">16</span>, <span class="string">b&#x27;\0&#x27;</span>)</span><br><span class="line">            </span><br><span class="line">        cipher = AES.new(aes_key, AES.MODE_CBC, iv=iv)</span><br><span class="line">        decrypted = cipher.decrypt(ct)</span><br><span class="line"></span><br><span class="line">        flag = unpad(decrypted, <span class="number">16</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n[SUCCESS] Flag: <span class="subst">&#123;flag.decode()&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[ERROR] 解密失败: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[-] 未找到符合条件的 m&quot;</span>)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># flag: ISCTF&#123;i7_533M5_Lik3_You_R34lLy_UNd3R574nd_Polinomials_4nD_RSA&#125;</span></span><br></pre></td></tr></table></figure></div>



<h4 id="baby-math"><a href="#baby-math" class="headerlink" title="baby_math"></a>baby_math</h4><hr>
<p>题目描述：死去的记忆突然被唤醒了</p>
<hr>
<p>打开：</p>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(flag)) </span><br><span class="line">R = RealField(<span class="number">1000</span>)</span><br><span class="line">a,b = bytes_to_long(flag[:<span class="built_in">len</span>(flag)//<span class="number">2</span>]),bytes_to_long(flag[<span class="built_in">len</span>(flag)//<span class="number">2</span>:])</span><br><span class="line">x   = R(<span class="number">0.75872961153339387563860550178464795474547887323678173252494265684893323654606628651427151866818730100357590296863274236719073684620030717141521941211167282170567424114270941542016135979438271439047194028943997508126389603529160316379547558098144713802870753946485296790294770557302303874143106908193100</span>)</span><br><span class="line"> </span><br><span class="line">enc = a*cos(x)+b*sin(x) </span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="comment">#1.24839978408728580181183027675785982784764821592156892598136000363397267152291738689909414790691435938223032351375697399608345468567445269769342300325192248438038963977207296241971217955178443170598629648414706345216797043374408541203167719396818925953801387623884200901703606288664141375049626635852e52</span></span><br></pre></td></tr></table></figure></div>

<p>给出<code>a * cos(x) + b * sin(x) = enc</code>，此为<strong>背包问题</strong>的变种</p>
<p>可以利用&#96;&#96;&#96;LLL算法&#96;&#96;，构造格，构造矩阵使得目标向量为格的一个<strong>短向量</strong>，利用<strong>格基约减</strong>求解。</p>
<p>EXP：</p>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">x_val_str = <span class="string">&quot;0.75872961153339387563860550178464795474547887323678173252494265684893323654606628651427151866818730100357590296863274236719073684620030717141521941211167282170567424114270941542016135979438271439047194028943997508126389603529160316379547558098144713802870753946485296790294770557302303874143106908193100&quot;</span></span><br><span class="line">enc_val_str = <span class="string">&quot;1.24839978408728580181183027675785982784764821592156892598136000363397267152291738689909414790691435938223032351375697399608345468567445269769342300325192248438038963977207296241971217955178443170598629648414706345216797043374408541203167719396818925953801387623884200901703606288664141375049626635852e52&quot;</span></span><br><span class="line"></span><br><span class="line">R = RealField(<span class="number">1000</span>)</span><br><span class="line">x = R(x_val_str)</span><br><span class="line">enc = R(enc_val_str)</span><br><span class="line"></span><br><span class="line">K = <span class="number">10</span>**<span class="number">300</span> </span><br><span class="line"></span><br><span class="line">M = Matrix(ZZ, [</span><br><span class="line">    [<span class="number">1</span>, <span class="number">0</span>, <span class="built_in">int</span>(K * cos(x))],</span><br><span class="line">    [<span class="number">0</span>, <span class="number">1</span>, <span class="built_in">int</span>(K * sin(x))],</span><br><span class="line">    [<span class="number">0</span>, <span class="number">0</span>, <span class="built_in">int</span>(K * enc)]</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">M_reduced = M.LLL()</span><br><span class="line">vec = M_reduced[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">a = <span class="built_in">abs</span>(vec[<span class="number">0</span>])</span><br><span class="line">b = <span class="built_in">abs</span>(vec[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[+] Found a: <span class="subst">&#123;a&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[+] Found b: <span class="subst">&#123;b&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    part1 = long_to_bytes(a)</span><br><span class="line">    part2 = long_to_bytes(b)</span><br><span class="line">    flag = part1 + part2</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\n[SUCCESS] Flag: <span class="subst">&#123;flag.decode()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[-] Decode failed: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># [SUCCESS] Flag: ISCTF&#123;164a3221-7306-4024-88c3-4ef557b86895&#125;</span></span><br></pre></td></tr></table></figure></div>



<h4 id="小蓝鲨的费马谜题"><a href="#小蓝鲨的费马谜题" class="headerlink" title="小蓝鲨的费马谜题"></a>小蓝鲨的费马谜题</h4><hr>
<p>题目描述：小蓝鲨在一次网络探险中发现了一个神秘的加密系统。他发现这个系统好像使用了费马小定理来保护重要信息，但是又好像不太一样。小蓝鲨设法截获了系统的加密输出，但不知道如何解密，你可以帮帮它吗？</p>
<hr>
<p>打开，还有25KB的<code>output.txt</code>：</p>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line">p = get_prime(<span class="number">1024</span>)</span><br><span class="line">q = get_prime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line">bases = get_primes_up_to(<span class="number">100</span>)</span><br><span class="line"></span><br><span class="line">hints = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(bases)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>, <span class="built_in">len</span>(bases)):</span><br><span class="line">        hint_value = (<span class="built_in">pow</span>(bases[i], p-<span class="number">1</span>, n) + <span class="built_in">pow</span>(bases[j], p-<span class="number">1</span>, n)) % n</span><br><span class="line">        hints.append((bases[i], bases[j], hint_value))</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>根据给定的hint：<code>H(a,b) = a ^ (p - 1) + b ^ (p - 1) mod n</code></p>
<p>与费马小定理<code>b ^ (p - 1) = c ^ (p - 1) = 1 (mod p)</code></p>
<p>得出<code>p = gcd(H(a,b) - H(a , c), n)</code></p>
<p>所以，EXP：</p>
<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> gcd</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, inverse</span><br><span class="line"></span><br><span class="line">path = <span class="string">&quot;D:\\task\\output.txt&quot;</span> </span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(path, <span class="string">&quot;r&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    txt = f.read()</span><br><span class="line"></span><br><span class="line">m_n = re.search(<span class="string">r&quot;n\s*=\s*([0-9]+)&quot;</span>, txt)</span><br><span class="line">m_e = re.search(<span class="string">r&quot;e\s*=\s*([0-9]+)&quot;</span>, txt)</span><br><span class="line">m_c = re.search(<span class="string">r&quot;c\s*=\s*([0-9]+)&quot;</span>, txt)</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> (m_n <span class="keyword">and</span> m_e <span class="keyword">and</span> m_c):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;未能从文件中读取 n/e/c，请确认输出格式与样例一致。&quot;</span>)</span><br><span class="line">    <span class="keyword">raise</span> SystemExit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">n = <span class="built_in">int</span>(m_n.group(<span class="number">1</span>))</span><br><span class="line">e = <span class="built_in">int</span>(m_e.group(<span class="number">1</span>))</span><br><span class="line">c = <span class="built_in">int</span>(m_c.group(<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Loaded n,e,c&quot;</span>)</span><br><span class="line"></span><br><span class="line">hint_tuples = re.findall(<span class="string">r&quot;Hint\s*\d+:\s*(\d+),\s*(\d+),\s*([0-9]+)&quot;</span>, txt)</span><br><span class="line">hints = [(<span class="built_in">int</span>(a), <span class="built_in">int</span>(b), <span class="built_in">int</span>(val)) <span class="keyword">for</span> (a,b,val) <span class="keyword">in</span> hint_tuples]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Loaded&quot;</span>, <span class="built_in">len</span>(hints), <span class="string">&quot;hints&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</span><br><span class="line">groups1 = defaultdict(<span class="built_in">list</span>)</span><br><span class="line">groups2 = defaultdict(<span class="built_in">list</span>)</span><br><span class="line"><span class="keyword">for</span> idx, (a,b,val) <span class="keyword">in</span> <span class="built_in">enumerate</span>(hints, start=<span class="number">1</span>):</span><br><span class="line">    groups1[a].append((idx,a,b,val))</span><br><span class="line">    groups2[b].append((idx,a,b,val))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">try_pairs</span>(<span class="params">pairs</span>):</span><br><span class="line">    results = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(pairs)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>, <span class="built_in">len</span>(pairs)):</span><br><span class="line">            idx1,a1,b1,H1 = pairs[i]</span><br><span class="line">            idx2,a2,b2,H2 = pairs[j]</span><br><span class="line">            delta = (H1 - H2) % n</span><br><span class="line">            g = gcd(delta, n)</span><br><span class="line">            <span class="keyword">if</span> <span class="number">1</span> &lt; g &lt; n:</span><br><span class="line">                results.append((idx1, a1,b1, idx2, a2,b2, g))</span><br><span class="line">    <span class="keyword">return</span> results</span><br><span class="line"></span><br><span class="line">found = []</span><br><span class="line"><span class="keyword">for</span> a, items <span class="keyword">in</span> groups1.items():</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(items) &gt;= <span class="number">2</span>:</span><br><span class="line">        res = try_pairs(items)</span><br><span class="line">        <span class="keyword">if</span> res:</span><br><span class="line">            found.extend(res)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> found:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Found factor(s) by matching same base1:&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> it <span class="keyword">in</span> found:</span><br><span class="line">        <span class="built_in">print</span>(it)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;No factor found by matching same base1. Trying same base2...&quot;</span>)</span><br><span class="line">    found2 = []</span><br><span class="line">    <span class="keyword">for</span> b, items <span class="keyword">in</span> groups2.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(items) &gt;= <span class="number">2</span>:</span><br><span class="line">            res = try_pairs(items)</span><br><span class="line">            <span class="keyword">if</span> res:</span><br><span class="line">                found2.extend(res)</span><br><span class="line">    <span class="keyword">if</span> found2:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Found factor(s) by matching same base2:&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> it <span class="keyword">in</span> found2:</span><br><span class="line">            <span class="built_in">print</span>(it)</span><br><span class="line">        found = found2</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> found:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;No factor found by same-base heuristics. Scanning all pairs (this may take some seconds)...&quot;</span>)</span><br><span class="line">    all_pairs = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(hints)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>, <span class="built_in">len</span>(hints)):</span><br><span class="line">            a1,b1,H1 = hints[i]</span><br><span class="line">            a2,b2,H2 = hints[j]</span><br><span class="line">            delta = (H1 - H2) % n</span><br><span class="line">            g = gcd(delta, n)</span><br><span class="line">            <span class="keyword">if</span> <span class="number">1</span> &lt; g &lt; n:</span><br><span class="line">                all_pairs.append((i+<span class="number">1</span>,a1,b1,j+<span class="number">1</span>,a2,b2,g))</span><br><span class="line">    <span class="keyword">if</span> all_pairs:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Found by scanning all pairs:&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> it <span class="keyword">in</span> all_pairs:</span><br><span class="line">            <span class="built_in">print</span>(it)</span><br><span class="line">        found = all_pairs</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;每个 base1 的 hint 数量：&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> a, items <span class="keyword">in</span> <span class="built_in">sorted</span>(groups1.items()):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;base1 =&quot;</span>, a, <span class="string">&quot;count =&quot;</span>, <span class="built_in">len</span>(items))</span><br><span class="line">        <span class="keyword">raise</span> SystemExit(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">g = found[<span class="number">0</span>][-<span class="number">1</span>]</span><br><span class="line">p = <span class="built_in">int</span>(g)</span><br><span class="line"><span class="keyword">if</span> n % p != <span class="number">0</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;警告: gcd 没能整除n:&quot;</span>, p)</span><br><span class="line">    <span class="keyword">raise</span> SystemExit(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">q = n // p</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\nRecovered p =&quot;</span>, p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Recovered q =&quot;</span>, q)</span><br><span class="line"></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse(e, phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    flag = long_to_bytes(m)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\nflag (bytes):&quot;</span>, flag)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;flag (utf-8):&quot;</span>, flag.decode())</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> exc:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;转换为 bytes 失败，m 的值:&quot;</span>, m)</span><br><span class="line">    <span class="keyword">raise</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># flag: ISCTF&#123;M0dIFi3D_f3RM47_7H30r3m_I5_fUn_8U7_h4rD3r!&#125;</span></span><br></pre></td></tr></table></figure></div>

<!--more-->
		</div>

		

		
		<ul class="post-tags-box text-lg mt-1.5 flex-wrap justify-center flex md:hidden">
			
			<li class="tag-item mx-0.5">
				<a href="../../../../tags/%E6%AF%94%E8%B5%9B%E4%B8%AA%E4%BA%BAWP/">#比赛个人WP</a>&nbsp;
			</li>
			
		</ul>
		

		

		
		<div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8">
			
			
			<div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
				<a class="next" rel="next" href="../../../11/07/Re%E7%BB%83%E4%B9%A0%E4%B9%8BASM%E6%B1%87%E7%BC%96%E9%80%86%E5%90%91/">
					<span class="title flex justify-center items-center">
						<span class="post-nav-title-item truncate max-w-48">Re练习之ASM汇编逆向</span>
						<span class="post-nav-item">Next posts</span>
					</span>
					<span class="right arrow-icon flex justify-center items-center">
						<i class="fa-solid fa-chevron-right"></i>
					</span>
				</a>
			</div>
			
		</div>
		


		
		<div class="comment-container px-2 sm:px-6 md:px-8 pb-8">
			<div class="comments-container mt-10 w-full ">
    <div id="comment-anchor" class="w-full h-2.5"></div>
    <div class="comment-area-title w-full my-1.5 md:my-2.5 text-xl md:text-3xl font-bold">
        Comments
    </div>
    

        
            
    <div id="waline"></div>
    <script type="module" data-swup-reload-script>
      import { init } from '../../../../js/libs/waline.mjs';

      function loadWaline() {
        init({
          el: '#waline',
          serverURL: 'https://waline-pi-blue-88.vercel.app/',
          dark: 'body[class~="dark-mode"]',
          reaction: true,
          requiredMeta: ['nick', 'mail'],
          emoji: [],
                    lang: 'zh-CN',
        });
      }

      if (typeof swup !== 'undefined') {
        loadWaline();
      } else {
        window.addEventListener('DOMContentLoaded', loadWaline);
      }
    </script>



        
    
</div>

		</div>
		
	</div>

	
	<div class="toc-content-container">
		<div class="post-toc-wrap">
	<div class="post-toc">
		<div class="toc-title">On this page</div>
		<div class="page-title">ISCTF2025 部分题WP</div>
		<ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#SIGNIN"><span class="nav-number">1.</span> <span class="nav-text">SIGNIN</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MISC"><span class="nav-number">2.</span> <span class="nav-text">MISC</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#REVERSE"><span class="nav-number">3.</span> <span class="nav-text">REVERSE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CRYPTO"><span class="nav-number">4.</span> <span class="nav-text">CRYPTO</span></a></li></ol>

	</div>
</div>
	</div>
	
</div>
			</div>

			
		</div>

		<div class="main-content-footer">
			<footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color">
    <div class="info-container py-3 text-center">
        
        <div class="text-center">
            &copy;
            
              <span>2024</span>
              -
            
            2025&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration: 0.5s; color: #f54545"></i>&nbsp;&nbsp;<a href="/">debu8ger</a>
            
                
                <p class="post-count space-x-0.5">
                    <span>
                        21 posts in total
                    </span>
                    
                </p>
            
        </div>
        
            <script data-swup-reload-script src="https://cn.vercount.one/js"></script>
            <div class="relative text-center lg:absolute lg:right-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-right">
                
                    <span id="busuanzi_container_site_uv" class="lg:!block">
                        <span class="text-sm">VISITOR COUNT</span>
                        <span id="busuanzi_value_site_uv"></span>
                    </span>
                
                
                    <span id="busuanzi_container_site_pv" class="lg:!block">
                        <span class="text-sm">TOTAL PAGE VIEWS</span>
                        <span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left">
            <span class="lg:block text-sm">POWERED BY <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a></span>
            <span class="text-sm lg:block">THEME&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.8.5</a></span>
        </div>
        
        
            <div>
                Blog up for <span class="odometer" id="runtime_days" ></span> days <span class="odometer" id="runtime_hours"></span> hrs <span class="odometer" id="runtime_minutes"></span> Min <span class="odometer" id="runtime_seconds"></span> Sec
            </div>
        
        
            <script data-swup-reload-script>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
        
    </div>  
</footer>
		</div>
	</div>

	
	<div class="post-tools">
		<div class="post-tools-container">
	<ul class="article-tools-list">
		<!-- TOC aside toggle -->
		
		<li class="right-bottom-tools page-aside-toggle">
			<i class="fa-regular fa-outdent"></i>
		</li>
		

		<!-- go comment -->
		
		<li class="go-comment">
			<i class="fa-regular fa-comments"></i>
		</li>
		
	</ul>
</div>
	</div>
	

	<div class="right-side-tools-container">
		<div class="side-tools-container">
	<ul class="hidden-tools-list">
		<li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center">
			<i class="fa-regular fa-magnifying-glass-plus"></i>
		</li>

		<li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center">
			<i class="fa-regular fa-magnifying-glass-minus"></i>
		</li>

		<li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center">
			<i class="fa-regular fa-moon"></i>
		</li>

		<!-- rss -->
		

		

		<li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center">
			<i class="fa-regular fa-arrow-down"></i>
		</li>
	</ul>

	<ul class="visible-tools-list">
		<li class="right-bottom-tools toggle-tools-list flex justify-center items-center">
			<i class="fa-regular fa-cog fa-spin"></i>
		</li>
		
		<li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center">
			<i class="arrow-up fas fa-arrow-up"></i>
			<span class="percent"></span>
		</li>
		
		
	</ul>
</div>
	</div>

	<div class="image-viewer-container">
	<img src="">
</div>

	
	<div class="search-pop-overlay">
	<div class="popup search-popup">
		<div class="search-header">
			<span class="search-input-field-pre">
				<i class="fa-solid fa-keyboard"></i>
			</span>
			<div class="search-input-container">
				<input autocomplete="off" autocorrect="off" autocapitalize="off" placeholder="Search..." spellcheck="false" type="search" class="search-input">
			</div>
			<span class="popup-btn-close">
				<i class="fa-solid fa-times"></i>
			</span>
		</div>
		<div id="search-result">
			<div id="no-result">
				<i class="fa-solid fa-spinner fa-spin-pulse fa-5x fa-fw"></i>
			</div>
		</div>
	</div>
</div>
	

</main>



<script src="js/build/libs/Swup.min.js"></script>

<script src="js/build/libs/SwupSlideTheme.min.js"></script>

<script src="js/build/libs/SwupScriptsPlugin.min.js"></script>

<script src="js/build/libs/SwupProgressPlugin.min.js"></script>

<script src="js/build/libs/SwupScrollPlugin.min.js"></script>

<script src="js/build/libs/SwupPreloadPlugin.min.js"></script>

<script>
    const swup = new Swup({
        plugins: [
            new SwupScriptsPlugin({
                optin: true,
            }),
            new SwupProgressPlugin(),
            new SwupScrollPlugin({
                offset: 80,
            }),
            new SwupSlideTheme({
                mainElement: ".main-content-body",
            }),
            new SwupPreloadPlugin(),
        ],
        containers: ["#swup"],
    });
</script>




	
<script src="js/build/tools/imageViewer.js" type="module"></script>

<script src="js/build/utils.js" type="module"></script>

<script src="js/build/main.js" type="module"></script>

<script src="js/build/layouts/navbarShrink.js" type="module"></script>

<script src="js/build/tools/scrollTopBottom.js" type="module"></script>

<script src="js/build/tools/lightDarkSwitch.js" type="module"></script>

<script src="js/build/layouts/categoryList.js" type="module"></script>



    
<script src="js/build/tools/localSearch.js" type="module"></script>




    
<script src="js/build/tools/codeBlock.js" type="module"></script>




    
<script src="js/build/layouts/lazyload.js" type="module"></script>




    
<script src="js/build/tools/runtime.js"></script>

    
<script src="js/build/libs/odometer.min.js"></script>

    
<link rel="stylesheet" href="assets/odometer-theme-minimal.css">




  
<script src="js/build/libs/Typed.min.js"></script>

  
<script src="js/build/plugins/typed.js" type="module"></script>











    
<script src="js/build/tools/tocToggle.js" type="module" data-swup-reload-script=""></script>

<script src="js/build/layouts/toc.js" type="module" data-swup-reload-script=""></script>

<script src="js/build/plugins/tabs.js" type="module" data-swup-reload-script=""></script>




<script src="js/build/libs/moment-with-locales.min.js" data-swup-reload-script=""></script>


<script src="js/build/layouts/essays.js" type="module" data-swup-reload-script=""></script>





	
</body>

</html>